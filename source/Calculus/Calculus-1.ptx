<?xml version="1.0" encoding="UTF-8" ?>
<!-- =================================================================================================== -->
<!-- To process this file with xsltproc do                                                        -->
<!--                                                                                              -->
<!-- (1) LaTeX/PDF:                                                                               -->
<!--     xsltproc -o minimal.tex PATH_TO/mathbook/xsl/pretext-latex.xsl source/main.ptx           -->
<!--     pdflatex minimal.tex                                                                     -->
<!--     xelatex minimal.tex                                                                      -->
<!--                                                                                              -->
<!-- (2) HTML:                                                                                    -->
<!--     xsltproc PATH_TO/mathbook/xsl/pretext-html.xsl source/main.ptx                           -->
<!--     <browser>  minimal.html                                                                  -->
<!--        ~/xsltproc/xsltproc.exe ~/mathbook/xsl/mathbook-html.xsl test.xml                     -->
<!--                                                                                              -->
<!-- (3) CoCalc worksheet (parameter causes a single file for output)                             -->
<!--     REMOVE the "X" in the double dash (which is not legal in an XML comment)                 -->
<!--     xsltproc -X-stringparam chunk.level 0 PATH_TO/mathbook/xsl/pretext-smc.xsl source/main.ptx   -->
<!--     <CoCalc> minimal.sagews                                                                  -->
<!--                                                                                              -->
<!-- (4) Sage doctesting                                                                          -->
<!--     REMOVE the "X" in the double dash (which is not legal in an XML comment)                 -->
<!--     xsltproc -X-stringparam chunk.level 0 PATH_TO/mathbook/xsl/pretext-sage-doctest.xsl source/main.ptx  -->
<!--     <read further instructions in> minimal.py                                                -->
<!-- =================================================================================================== -->

<chapter xml:id="Chap-Calculus_1">



<!-- =================================================================================================== -->
<!-- Title and Other Preliminaries -->
<!-- =================================================================================================== -->
        <title>CA1: Maclaurin Series</title>

        <!-- <frontmatter> -->

<!--             <titlepage>
                <author>
                    <institution>University of Newcastle</institution>
                </author>
                <date><today /></date>
            </titlepage> -->

            <!-- <abstract>
                <p>This is a very short article, but it still exercises some advanced features of MathBook XML.</p>
            </abstract> -->

        <!-- </frontmatter> -->

        <!-- <introduction>
            <p>This is a short paragraph to introduce the article (but it is not the abstract).  It is optional, in case it would be preferable to have the first section be titled an <q>Introduction.</q></p>
        </introduction> -->
<!-- =================================================================================================== -->




<!-- =================================================================================================== -->
<!-- Section 1: Introduction-->
<!-- =================================================================================================== -->
    <section xml:id="Sec-Introduction">
        <title>Introduction</title>

        <aside>
                <title>Faster multiplication</title>
                <p>
                    There are actually multiplication algorithms which are significantly faster than long multiplication.
                    Long multiplication of of two <m>n</m>-digit numbers will typically take <m>n^2</m> single-digit multiplications 
                    (and another <m>n</m> <m>n</m>-digit additions). 

                    The  
                    <url href="https://www.quantamagazine.org/mathematicians-discover-the-perfect-way-to-multiply-20190411/"> fastest known algorithm </url>
                    is due to David Harvey and Joris van der Hoeven, and requires a number of steps proportional to <m>n\ln(n)</m>, which for large value of <m>n</m>
                    is a significant improvement.
                </p>
                
            </aside>

        <p>
            Have you ever wondered how computers actually calculate things? 
            Computers can only ever do finitely many steps with finitely many bits of information.
            The inputs in a calculation are numbers represented by finitely many (decimal or binary) digits, for example <m>x=0.3</m> and <m>y=1.744</m>. 
            You probably learned in primary school how to do long addition or multiplication with pencil and paper, and you could imagine that your computer might follow a similar algorithm and compute <m>x+y = 2.044</m> in a finite number of steps.
            
            But then how does it calculate <m>e^x</m> or <m>\sin(x)</m>, or other non-polynomial functions?
        </p>

        <p>
            The solution is to <em>approximate</em> the function using a <em>power series</em>. For example, the computer approximates <m>e^{0.3}</m> by adding finitely many terms of 
            <men xml:id="eq-e0.3">
                e^{0.3} = 1 + 0.3 + \frac{1}{2}(0.3)^2 + \frac{1}{6}(0.3)^3 + \frac{1}{24}(0.3)^4 + \cdots 
            </men>
            in other words, it approximates the <em>function</em> <m>e^x</m> via the <em>power series</em> 
            <md>
                <mrow> e^x \amp = 1 + x + \frac{1}{2}x^2 + \frac{1}{6}x^3 + \frac{1}{24}x^4 + \cdots  </mrow>
                <mrow>     \amp = \sum_{n=0}^{\infty} \frac{1}{n!}x^n.</mrow>
            </md>
        </p>

        <aside>
            <title>Factorials</title>
            <p>
                Here <m>n! = 1\cdot 2 \cdot 3 \cdots n</m> is <m>n</m> <term>factorial</term>. 
                It grows really fast:
                <md>
                <mrow> 0! \amp = 1</mrow>
                <mrow> 1! \amp = 1</mrow>
                <mrow> 2! \amp = 2</mrow>
                <mrow> 3! \amp = 6</mrow>
                <mrow> 4! \amp = 24</mrow>
                <mrow> 5! \amp = 120</mrow>
                <mrow> 6! \amp = 720</mrow>
                <mrow> \amp \vdots </mrow>
                <mrow> 10! \amp = 3628800 </mrow>
                </md>
                The factorial satifies the useful property that <m>(n+1)! = (n+1)n!</m>, meaning that fractions with factorials in the numerator and denominator will often allow lots of cancellation.
            </p>

            <p>
                <term>Challenge:</term> Determine the number of zeroes at the end of the decimal expression for <m>100!</m>
            </p>
        </aside>
            
    

        <p>
            How does the computer know how many of these terms to add? The short answer is: as many as needed to get the required level of accuracy. 
            The long answer is much more complicated, and is the subject of a whole other area of Mathematics called <em>Numerical Analysis</em>.  
        </p>

        <p>
            How does the computer know to use this particular series? And what even <em>is</em> a series? That's what we'll learn in this chapter!
        </p>

    </section>

<!-- =================================================================================================== -->
<!-- Section 2: Infinite Series-->
<!-- =================================================================================================== -->

    <section xml:id="Sec-Infinite_Series">
        <title>Infinite Series</title>

        <p>
            Let's look carefully at the calculation <xref ref="eq-e0.3"/>. We will add the terms one by one and keep an eye on the cumulative total, more formally known as the <term>partial sums</term>:
        </p>

        <tabular top="minor">
            <row header="yes" bottom="minor" left="minor">
                <cell halign="center" right="minor">Number of Terms</cell>
                <cell halign="center" right="minor">Partial Sum</cell>
                <cell halign="center" right="minor">Value</cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>1</m></cell>
                <cell right="minor"><m>1</m></cell>
                <cell right="minor"><m>1</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>2</m></cell>
                <cell right="minor"><m>1+0.3</m></cell>
                <cell right="minor"><m>1.3</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>3</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}</m></cell>
                <cell right="minor"><m>1.345</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>4</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}+\dfrac{0.3^3}{3!}</m></cell>
                <cell right="minor"><m>1.3495</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>5</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}+\dfrac{0.3^3}{3!}+\dfrac{0.3^4}{4!}</m></cell>
                <cell right="minor"><m>1.3498375</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>6</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}+\dfrac{0.3^3}{3!}+\dfrac{0.3^4}{4!}+\dfrac{0.3^5}{5!}</m></cell>
                <cell right="minor"><m>1.3498775</m></cell>
            </row>
        </tabular>

        <p>
            If you're viewing this online, you can compute this yourself by running the following Sage cell:
        </p>

        <sage>
            <input>
                x = 0.3
                answer = 0
                for k in range(10):
                    answer = answer + x^k/factorial(k)
                    print(n(answer))
            </input>
            <output>
            </output>
        </sage>

        <p> 
            This computation is actually quite inefficient, since we're calculating each term from scratch. 
            Notice that the <m>k^{\mathrm{th}}</m> term is obtained by multiplying the previous term by <m>\frac{x}{k}</m>:
            <me>
                \frac{x^k}{k!} = \left(\frac{x^{k-1}}{(k-1)!}  \right) \cdot \frac{x}{k}.
            </me>
            
            Firstly, this allows us to calculate the sum more efficiently:
            <aside>
                <title>Efficiency</title>
                <p>
                    We do we care about efficiency? Aren't modern computers plenty fast enough? For this example, yes. 
                    But there are often cases where we need to compute efficiently, for example in mobile devices with limited power,
                    or calculations that need to be repeated millions of times per second, for example in computer graphics.
                </p>
            </aside>

            <sage>
                <input>
                    N = 10        # the highest power of x we will include in our sum
                    x = 0.3
                    t = 1         # the zeroth term
                    answer = 1    # we start with the first term, then compute additional terms:
                    for k in range(1, N+1):
                        t = t * x / k    # calculate the kth term
                        answer = answer +  t
                        print('k = ', k, '; partial sum = ', n(answer))
                </input>
                <output>
                </output>
            </sage>

            Secondly, as we add more terms, <m>k</m> gets ever bigger while <m>x</m> stays the same, so the multiplier <m>\frac{x}{k}</m> we use to get from one term to the next gets ever smaller. 
            This means that the terms shrink to zero exponentially and we will see in the next chapter (<xref ref="Calculus_2"/>) that the sum <em>converges</em> for every value of <m>x</m>.
            
        </p>    

        <p>
            In the above calculation, we have only computed finitely many terms, which is all one ever needs for applications. 
            Mathematically, however, <xref ref="eq-e0.3"/> is an <em>infinite</em> series, and its value represents the sum of all infinitely many terms. 
            What can this mean? 
        </p>
        <p>
            We have seen that the partial sums tend to <m>1.34985880757600\ldots</m>, and this <em>limit</em> is defined to the be sum of the infinite series:
            <me>
                e^{0.3} = \sum_{k=0}^{\infty} \frac{(0.3)^k}{k!} := \lim_{N\rightarrow\infty} \sum_{k=0}^{N} \frac{(0.3)^k}{k!}
            </me>
        </p>

        <definition xml:id="def-series">
            <statement>
                <p>
                    Given a <term>sequence</term> <m>a_0, a_1, a_2, \ldots</m> of real numbers (the terms), we define the <term>series</term>
                    <men xml:id="eq-series">
                        \sum_{k=0}^{\infty} a_k := \lim_{N\rightarrow\infty} \sum_{k=0}^N a_k
                    </men>
                    to be the limit of the partial sums (running totals) of the terms, provided that this limit exists.
                </p>
                <p>
                    If the limit <xref ref="eq-series"/> exists, we say that the series <term>converges</term>, otherwise it <term>diverges.</term>                    
                </p>
            </statement>
        </definition>

        <p>
            We will learn more about convergence and divergence in the next chapter. 
            For now, we're interested in using infinite series to represent useful functions, like <m>e^x</m>, <m>\sin(x)</m> or <m>\cos(x)</m>.
        </p>
        

    </section>

<!-- =================================================================================================== -->
<!-- Section 3: Power Series-->
<!-- =================================================================================================== -->


    <section xml:id="sec-Power-Series">
        <title>Power Series</title>

        <p>
            Our first example above shows that the function <m>e^x</m> can be expressed as an infinite series in the following form:
            <men xml:id="eq-exp-series">
                e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots = \sum_{k=0}^{\infty} \frac{x^k}{k!}.
            </men>
            Note that each term consists of a <em>coefficient</em> (for example <m>\frac{1}{3!}</m>) multiplied by some power of the variable (for example <m>x^3</m>), 
            so this is an example of what we call a <term>power series</term>.
            Power series are particularly useful, as we can approximate them by the sum of the first few terms, which is then a polynomial. We're very comfortable with polynomials.
            Figure <xref ref="fig-exp-plot"/> shows how the first few partial sums of the series <xref ref="eq-exp-series"/> approximate the function <m>e^x</m>.

            <figure width="100%" xml:id="fig-exp-plot">
                <caption>Approximation to <m>e^x</m> by various partial sums of its power series</caption>
                <image xml:id="sage-exp-plot" source="Calculus/Images/1/exp-power-series-plot.svg" width="100%">
                    <description>A plot of <m>y=e^x</m> together with plots of the partial sums of its power series of degrees <m>0, 1, 2</m> and <m>3</m>.</description>
                </image>
            </figure>
            
        
            <aside>
            <p>
                Power series aren't the only way to represent interesting functions: there are also other types of series, infinite products, continued fractions...
            </p>
            </aside>
        </p>
        <p>
            Assuming for now that the series <xref ref="eq-exp-series" /> converges, how do we know this is even true? How does one find such a series?
        </p>

    </section>

<!-- =================================================================================================== -->
<!-- Section 4: Maclaurin Series-->
<!-- =================================================================================================== -->

    <section xml:id="sec-Maclaurin-Series">
        <title>Maclaurin Series</title>
        
    
        <p>
        
            Let's suppose for the moment that a power series representation for a function <m>f(x)</m> <em>exists</em>, but we don't know what the coefficients should be:
            <men xml:id="eq-fx-power-series">
                f(x) = c_0 + c_1x + c_2x^2 + \cdots.
            </men>
            We can find the value of the first coefficient by the clever trick of plugging <m>x=0</m> into <xref ref="eq-fx-power-series" />:
            <me>
                f(0) = c_0 + c_10 + c_20^2 + c\dots = c_0.
            </me>
            What about the next coefficient? We use an even cleverer trick: <em>differentiating</em> the series kills the first coefficient and decreases the exponent in all other coefficients:
            <md>
                <mrow>f'(x) \amp = \frac{d}{dx} \big( c_0 + c_1x + c_2x^2 + c_3x^3 + \cdots \big) </mrow>
                <mrow>\amp = c_1 + 2c_2x + 3c_3x^2 + \cdots.</mrow>
            </md>
            Plugging <m>x=0</m> into this gives us <m>c_1 = f'(0)</m>. Let's differentiate another time:
            <md>
                <mrow>f''(x) \amp = \frac{d}{dx} \big( c_1 + 2c_2x + 3c_3x^2 + 4c_4x^3 + \cdots \big)</mrow>
                <mrow>\amp = 2c_2 + 6c_3 + 12 c_4 + \cdots</mrow>
                <mrow> \Rightarrow f''(0) \amp = 2c_2</mrow>
            </md>
            so <m>c_2 = \frac{1}{2}f''(0)</m>, next <m>c_3 = \frac{1}{6}f'''(0)</m>, etc. In general, we find
        </p>

        <theorem xml:id="thm-Maclaurin">
            <creator>Maclaurin</creator>
            <statement>
                <p>
                    Let <m>I</m> be an open interval, and suppose that the power series <xref ref="eq-fx-power-series"/> converges to <m>f(x)</m> for <m>x\in I</m>. 
                    Then, for <m>x\in I</m>, 
                    <men xml:id="eq-Maclaurin">
                        f(x) = \sum_{k=0}^{\infty} \frac{f^{(k)}(0)}{k!}x^k.
                    </men>
                    
                </p>
            </statement>
        </theorem>

        <exercise>
            <statement>
                <p>
                    Use induction on <m>k</m> to prove that the expression in <xref ref="thm-Maclaurin"/> is correct.
                </p>
            </statement>
            
        </exercise>

        <p>
            The series expansion <xref ref="eq-Maclaurin"/> is called the <term>Maclaurin series</term> for the function <m>f(x)</m>.
        </p>

        <p>
            So now that we know how to create power series for functions using their derivatives, let's do the same for two more important functions:
        </p>
        
        <example>
            <statement>
                <p>
                    Compute the Maclaurin series for <m>\sin(x)</m>.
                </p>
            </statement>
            <answer>
                <p>
                    <me>
                        \sin(x) = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots 
                        = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k+1}}{(2k+1)!}
                    </me>
                    
                </p>
            </answer>
            <solution>
                <p>
                    We compute the derivatives of <m>f(x)=\sin(x)</m>:                    
                    <md>
                        <mrow>f(x) \amp = \sin(x) \amp  f'(x) \amp = \cos(x) </mrow>
                        <mrow>f''(x) \amp = -\sin(x) \amp  f'''(x) \amp = -\cos(x) </mrow>
                    </md>
                    thereafter, the pattern repeats, so <m>f^{(4)}(x) = \sin(x)</m> again, etc. 
                </p>
                <p>
                    Plugging in <m>x=0</m>, we get
                    <md>
                        <mrow>f(0) \amp = 0 \amp  f'(0) \amp = 1 </mrow>
                        <mrow>f''(0) \amp = 0 \amp  f'''(0) \amp = -1, \quad\text{etc.}</mrow>
                    </md>
                </p>
                <p>
                    Now we put it all together:
                    <md>
                        <mrow>f(x) \amp = f(0) + f'(0)x + \frac{f''(0)'x^2}{2!} + \cdots </mrow>
                        <mrow> \amp = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots </mrow>
                        <mrow> \amp = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k+1}}{(2k+1)!}. </mrow>
                    </md> 
                    To get the last expression, note that the non-zero terms correspond to odd powers of <m>x</m>, and odd numbers are of the form <m>2k+1</m>. 
                    The <m>(-1)^k</m> then ensures the alternating signs.
                </p>
            </solution>
        </example>

        <example>
            <statement>
                <p>
                    Compute the Maclaurin series for <m>\cos(x)</m>.
                </p>
            </statement>
            <answer>
                <p>
                    <me>
                        \cos(x) = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots 
                        = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k}}{(2k)!}
                    </me>
                </p>
            </answer>
            <solution>
                <p>
                    We compute the derivatives of <m>f(x)=\cos(x)</m>:                    
                    <md>
                        <mrow>f(x) \amp = \cos(x) \amp  f'(x) \amp = -\sin(x) </mrow>
                        <mrow>f''(x) \amp = -\cos(x) \amp  f'''(x) \amp = \sin(x) </mrow>
                    </md>
                    thereafter, the pattern repeats, so <m>f^{(4)}(x) = \cos(x)</m> again, etc. 
                </p>
                <p>
                    Plugging in <m>x=0</m>, we get
                    <md>
                        <mrow>f(0) \amp = 1 \amp  f'(0) \amp = 0 </mrow>
                        <mrow>f''(0) \amp = -1 \amp  f'''(0) \amp = 0, \quad\text{etc.}</mrow>
                    </md>
                </p>
                <p>
                    Now we put it all together:
                    <md>
                        <mrow>f(x) \amp = f(0) + f'(0)x + \frac{f''(0)'x^2}{2!} + \cdots </mrow>
                        <mrow> \amp = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots </mrow>
                        <mrow> \amp = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k}}{(2k)!}. </mrow>
                    </md> 
                    To get the last expression, note that the non-zero terms correspond to even powers of <m>x</m>, and even numbers are of the form <m>2k</m>. 
                    The <m>(-1)^k</m> then ensures the alternating signs.
                </p>
            </solution>
        </example>

        <p>
            We record the Maclaurin series we have found thus far:
            <md>
                <mrow>e^x \amp = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \cdots = \sum_{k=0}^{\infty} \frac{x^k}{k!}</mrow>
                <mrow>\sin(x) \amp =  x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots 
                        = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k+1}}{(2k+1)!} </mrow>
                <mrow> \cos(x) \amp =  1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots 
                        = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k}}{(2k)!}. </mrow>
            </md>
        </p>
        
    </section>

<!-- =================================================================================================== -->
<!-- Section 5: Euler's Formula -->
<!-- =================================================================================================== -->

    <section xml:id="sec-Eulers-Formula">
        <title>Euler's Formula</title>
        
    

    <p>
        You may have noticed that the Maclaurin series for <m>e^x, \sin(x)</m> and <m>\cos(x)</m> all look very similar - 
        the series for <m>\sin(x) + \cos(x)</m> has exactly the same terms as the series for <m>e^x</m>, except for the differences in signs.
    </p>
    <p>
        It turns out we can fix these signs if we subsitute <m>x = i\theta</m>, where <m>i=\sqrt{-1}</m> is the imaginary unit.
        Using the fact that
        <md>
            <mrow>\amp i^0 = 1, \amp \amp i^1 = i, \amp \amp i^2 = -1, \amp \amp i^3 = -i, \amp \amp i^4 = i^0 = 1, \amp \amp i^5 = i^1 = i, \; \text{etc.} </mrow>
        </md>
        we find that 
        <md>
            <mrow>e^{i\theta} \amp = 1 + i\theta + i^2\frac{\theta^2}{2!} + i^3\frac{\theta^3}{3!} + i^4\frac{\theta^4}{4!} + \cdots  </mrow>
            <mrow> 
              \amp = \big[1 -  \frac{\theta^2}{2!} + \frac{\theta^4}{4!} - \cdots\big]
              + i\big[\theta -  \frac{\theta^3}{3!} + \frac{\theta^5}{5!} - \cdots\big]
            </mrow>
            <mrow> \amp = \cos(\theta) + i\sin(\theta).</mrow>
        </md>
    </p>

    <p>
        <theorem xml:id="thm-eulers-formula">
            <creator>Euler</creator>
            <statement>
                <p>
                    For <m>\theta\in\mathbb{R}</m> we have
                    <me>
                        e^{i\theta} = \cos(\theta) + i\sin(\theta).
                    </me>
                    
                </p>
            </statement>
        </theorem>

        In particular, if we set <m>\theta = \pi</m>, we obtain the following amazing formula, which combines the five most important constants in Mathematics: 
        <men xml:id="eqn-Euler">
            e^{\pi i} + 1 = 0
        </men>
        

        <aside>
            <title>The most beautiful formula</title>
            <p>
                A survey at the 2006 International Congress of Mathematicians in Madrid, Spain, asked delegates from all over the world what they thought was the most beautiful mathematical formula.
                The winner, by far, was Euler's formula <xref ref="eqn-Euler"/>.
            </p>
        </aside>
        
    </p>

    </section>

<!-- =================================================================================================== -->
<!-- Section 6: Maclaurin Polynomials-->
<!-- =================================================================================================== -->

    <section xml:id="sec-Maclaurin-Polynomials">
        <title>Maclaurin Polynomials</title>
        <p>
            Now we have a method for obtaining power series expressions for functions. 
            But these are infinite series, and for most applications we want to approximate our functions with finite polynomials. 
            That's really easy - we just cut off the series after a finite number of terms:
        </p>
        <p>
            <definition xml:id="def-Maclaurin-polynomial">
                <statement>
                    <p>
                        The <term>degree <m>n</m> Maclaurin polynomial</term> of a function <m>f(x)</m> is 
                        <me>
                            T_n f(x) := f(0) + f'(0)x + \frac{f''(0)x^2}{2!} + \cdots + \frac{f^{(n)}x^n}{n!}.
                        </me>
                    </p>
                </statement>
            </definition>
        </p>
        <p>
            Note that the degree <m>n</m> Maclaurin polynomial will generally consist of <m>n+1</m> terms. 
            However, it will have degree less than <m>n</m> if the coefficient of <m>x^n</m> equals zero, for example
            <me>
                T_3\cos(x) = 1 - \frac{1}{2}x^2.
            </me>
            
        </p>
        <p>
            The degree 0 Maclaurin polynomial of <m>f(x)</m> is not very interesting, it's the just the constant function <m>f(0)</m>.
        </p>
        <p>
            You'll recognise the degree 1 Maclaurin polynomial <m>T_1f(x) = f(0) + f'(0)x</m>: its graph is the tangent to <m>y=f(x)</m> at <m>x=0</m>. 
            We also call it the <term>linear approximation</term> to <m>f(x)</m>, it is the linear function that most closely approximates <m>f(x)</m> near <m>x=0</m>. 
        </p>
        <p>
            Similarly, the degree 2 Maclaurin polynomial <m>T_2f(x) = f(0) + f'(0)x + \frac{f''(0)}{2}x^2</m> is called the <term>quadratic approximation</term> to <m>f(x)</m>.
            It is the quadratic function closest to <m>f(x)</m> near <m>x=0</m>.
        </p>

        <p>
            The following Sage cell let's you plot the Maclaurin polynomials for <m>e^x, \sin(x)</m> and <m>\cos(x)</m>:
        </p>

        <sage>
            <input>
                x   = var('x')
                x0  = 0

                @interact
                def _(order=slider([1 .. 12]),
                    f=selector([exp(x), sin(x), cos(x)])
                    ):
                    p = plot(f, -2*pi, 2*pi, thickness=2, legend_label='$f(x)$')
                    dot = point((x0, f(x=x0)), pointsize=80, rgbcolor=(1, 0, 0))
                    ft = f.taylor(x, x0, order)
                    pretty_print(html(fr'$f(x) = {latex(f)}$'))
                    pretty_print(html(fr'$T_{{{order}}}f(x) = {latex(ft)}$')) 
                    pt = plot(ft, -2*pi, 2*pi, color='green', thickness=1, linestyle='--', legend_label = fr'$T_{order}f(x)$')
                    G = dot + p + pt
                    G.set_legend_options(font_size='x-large', loc='lower right', handlelength=0.01)
                    show(G, ymin=-2, ymax=2, figsize=5)
            </input>
            <output>
            </output>
        </sage>

        <remark>
            <title>Computer algebra systems</title>
                <p>
                    Computer Algebra Systems usually have a command for calculating Maclaurin series. 
                    For example, the following shows part of the output from a <url href="https://www.wolframalpha.com/">Wolfram Alpha</url> query.
                </p>
                <figure xml:id="Fig-C1_WA_3">
                    <image source="Calculus/Images/1/C1_WA_3.png" width="100%"/>
                </figure>

                <p>
                    We have already seen Sage code to compute Maclaurin series, here is the simplest code:
                </p>

                <sage>
                    <input>
                        taylor(cos(x), x, 0, 10)
                    </input>
                    <output>
                    </output>
                </sage>
                
        </remark>
        
    </section>





<!-- =================================================================================================== -->
<!-- Section ??: Advanced topics-->
<!-- =================================================================================================== -->

    <section xml:id="sec-Advanced-Topics">
        <title>Advanced Topics</title>


        <subsection xml:id="subsec-Computing-pi">
            <title>Computing <m>\pi</m></title>
            <p>
                <m>\pi = 3.14159265358979323846264338327950288419716939937510582097\ldots</m>
            </p>

            <p>
                It's not hard to show, using repeated differentiation, that the Maclaurin series for <m>\arctan(x)</m> is
                <men xml:id="eqn-arctan">
                    \arctan(x) = x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \cdots = \sum_{k=0}^{\infty} (-1)^k\frac{x^{2k+1}}{2k+1}.
                </men>
                Since <m>\arctan(1) = \frac{\pi}{4}</m>, this gives us an infinite series converging to <m>\pi</m>:
                <men xml:id="eqn-pi1">
                    \pi = 4 - \frac{4}{3} + \frac{4}{5} - \frac{4}{7} + \cdots.
                </men>
            </p>

            <sage>
                <input>
                    N = 20
                    s = 0
                    for k in range(N):
                        s = s + (-1)^k*4/(2*k+1)
                        print(n(s))
                </input>
                <output>
                </output>
            </sage>

            <p>
                As you can see from this computation, convergence is extremely slow. 
                See how big you must make N in the above code before you get two correct digits after the decimal point.
            </p>

            <p>
                One can compute <m>\pi</m> much faster by using identities such as the following, due to John Machin (in 1706):
                <men xml:id="eqn-arctan2">
                    \frac{\pi}{4} = 4\arctan\frac{1}{5} - \arctan\frac{1}{239}.
                </men>
            </p>
            
            <sage>
                <input>
                    N = 10
                    s = 0
                    for k in range(N):
                        s = s + n( (-1)^k * ( (16*(1/5)^(2*k+1))/(2*k+1) - (4*(1/239)^(2*k+1))/(2*k+1) ), 200)
                        print(s)
                </input>
                <output>
                </output>
            </sage>

            <p>
                Modern algorithms to compute <m>\pi</m> are more sophisticated and much faster still, 
                see <url href="https://en.wikipedia.org/wiki/Pi" />. 
                We mention only one method, the BBP (Bailey-Borwein-Plouffe) Algorithm:
                <men xml:id="eqn-BBP">
                    \pi = \sum_{k=0}^{\infty} \frac{1}{16^k} \left( 
                        \frac{4}{8k+1} - \frac{2}{8k+4} - \frac{1}{8k+5} - \frac{1}{8k+6}
                        \right)
                </men>
                This formula not only converges extremely quickly, but it also allows you to compute specific 
                hexadecimal digits of <m>\pi</m> without first computing the previous digits.
            </p>

            <sage>
                <input>
                    N = 10
                    s = 0
                    for k in range(N):
                        s = s + (1/16^k)*( 4/(8*k+1) - 2/(8*k+4) - 1/(8*k+5) - 1/(8*k+6) )
                        print(n(s, 200))
                </input>
                <output>
                </output>
            </sage>
            
            
            
        </subsection>

        <subsection xml:id="subsec-A-function-without-Maclaurin-series">
            <title>A function without Maclaurin series</title>
            
            
            <p>
                Consider the function
                <me>
                    f(x) = \begin{cases} e^{-1/x^2} \amp \text{if} \; x\neq 0 \\
                    0 \amp \text{if} \; x=0. \end{cases}
                </me>
                This function is well-defined and continuous at <m>x=0</m> - you can compute the limit
                <me>
                    \lim_{x \rightarrow 0} e^{-1/x^2} = 0.
                </me>
            </p>

            <figure width="100%" xml:id="fig-exp-minus-1-over-x-squared">
                <caption>Plot of <m>e^{-1/x^2}</m></caption>
                <image source="Calculus/Images/1/exp-minus-one-over-x-square-plot" width="100%">
                    <description>Plot of <m>y=e^{-1/x^2}</m></description>
                </image>
            </figure>
            
            
            <p>
                One can show that this function is well-defined and differentiable, in fact for <m>x\neq 0</m> we have (check this yourself):
                <md>
                    <mrow>\frac{d}{dx} f(x) \amp = \frac{2 \, e^{\left(-\frac{1}{x^{2}}\right)}}{x^{3}} </mrow>
                    <mrow>\frac{d^{ 2 }}{dx^{ 2 }} f(x) \amp = -\frac{6 \, e^{\left(-\frac{1}{x^{2}}\right)}}{x^{4}} + \frac{4 \, e^{\left(-\frac{1}{x^{2}}\right)}}{x^{6}}</mrow>
                    <mrow>\frac{d^{ 3 }}{dx^{ 3 }} f(x) \amp = \frac{24 \, e^{\left(-\frac{1}{x^{2}}\right)}}{x^{5}} - \frac{36 \, e^{\left(-\frac{1}{x^{2}}\right)}}{x^{7}} 
                    + \frac{8 \, e^{\left(-\frac{1}{x^{2}}\right)}}{x^{9}} </mrow>
                </md>
                The plot in <xref ref="fig-exp-minus-1-over-x-squared"/> is suspiciously flat near <m>x=0</m>, and in fact we have
                <me>
                    \left.\frac{d^k}{dx^k}f(x)\right|_{x=0} = 0, \quad \text{for all} \; k \geq 0.
                </me>
                Therefore, the Maclaurin series for <m>f(x)</m> is identically zero! So this function does not equal its Maclaurin series.
            </p>
            <p>
                Replacing <m>x</m> by <m>-1/x^2</m> in the power series for <m>e^x</m>, we get
                <me>
                    e^{-1/x^2} = \sum_{k=0}^{\infty} (-1)^k\frac{x^{-2k}}{k!} = 1 - x^{-2} + \frac{1}{2}x^{-4} - \frac{1}{6}x^{-6} + \cdots
                </me>
                This is not strictly a power series, but a <term>Laurent series</term>, which converges for <m>x\neq 0</m>.
            </p>

            <sage>
                <input>
                    x   = var('x')
                    f = exp(-1/x^2)
                    p = plot(f, -2, 2, thickness=2, legend_label='$f(x) = '+latex(f)+'$')

                    @interact
                    def _(order=slider([1 .. 12])
                        ):
                        ft = taylor(exp(x), x, 0, order)
                        g = ft(x=-1/x^2)
                        pretty_print(html(fr'$f(x) = {latex(f)}$'))
                        pretty_print(html(fr'$L_{{{order}}}f(x) = {latex(g)}$')) 
                        pt = plot(g, -2, 2, color='green', thickness=1, linestyle='--', legend_label = fr'$L_{{{order}}}f(x)$' )
                        G = p + pt
                        G.set_legend_options(font_size='x-large', loc='lower right', handlelength=0.01)
                        show(G, ymin=-2, ymax=2, figsize=5)
                </input>
                <output>
                </output>
            </sage>

            <p>
                Here we see that the partial sums approximate <m>f(x)</m> well for large <m>x</m>, but not for small <m>x</m>.
            </p>
            
        </subsection>


        <subsection xml:id="subsec-Other-types-of-series">
            <title>Other types of series</title>
            
            <p>
                For <m>s\gt 1</m> one can show that the following infinite series converges:
                <me>
                    \zeta(s) := \sum_{n=1}^{\infty} \frac{1}{n^s} = \frac{1}{1^s} + \frac{1}{2^s} + \frac{1}{3^s} + \cdots,
                </me>
                This defines the <term>zeta-function</term>, a fascinating function defined by a series other than a power series. 
                Later we will see that <m>\zeta(s)</m> is related to the distribution of prime numbers. 
                When <m>s</m> is an even integer, it takes on very interesting values:
                <md>
                    <mrow>\zeta(2) \amp = \frac{1}{1^2} + \frac{1}{2^2} + \frac{1}{3^2} + \cdots = \frac{\pi^2}{6} </mrow>
                    <mrow>\zeta(4) \amp = \frac{1}{1^4} + \frac{1}{2^4} + \frac{1}{3^4} + \cdots = \frac{\pi^4}{90}</mrow>
                    <mrow>\zeta(6) \amp = \frac{1}{1^6} + \frac{1}{2^6} + \frac{1}{3^6} + \cdots = \frac{\pi^6}{945}. \amp </mrow>
                </md>
                Its values at the odd integers are much more mysterious.
                
            </p>

            <exercise>
                <statement>
                    <p>
                        <!-- [Put in CA2??] -->
                        Show that 
                        <me>
                            \lim_{s \rightarrow 1^-} \zeta(s) = \infty,
                        </me>
                        in other words, the <term>harmonic series</term>
                        <me>
                            \frac{1}{1} + \frac{1}{2} + \frac{1}{3} + \cdots 
                        </me>
                        diverges.
                    </p>
                </statement>
                <hint>
                    <p>
                        Show that the partial sum <m>\sum_{k=1}^N \frac{1}{k}</m> is greater than the integral <m>\int_1^{N-1}\frac{1}{x}dx = \ln(N-1)</m>.
                    </p>
                </hint>
                
            </exercise>

        </subsection>


        <subsection xml:id="subsec-Infinite-products">
            <title>Infinite products</title>

            <p>
                Instead of adding infinitely many terms, one might also multiply them. 
                Thus one may express some functions as infinite products, for example
                <md>
                    <mrow>\sin x \amp = x\prod_{n=1}^{\infty} \left(1 - \frac{x^2}{\pi^2n^2}\right) </mrow>
                    <mrow>\cos x \amp = \prod_{n=1}^{\infty} \left(1 - \frac{x^2}{\pi^2\left(n-\frac{1}{2}\right)^2}\right)</mrow>
                </md>
                Such products can only converge if the factors tend to <m>1</m> (not 0!) as <m>n</m> tends to infinity.
            </p>
            <p>
                You can plot the finite products against <m>\sin(x)</m> and <m>\cos(x)</m> in the following Sage cells:


            </p>

            <sage>
                <input>
                    x   = var('x')
                    f = sin(x)
                    pf = plot(f, -2*pi, 2*pi, thickness=2, legend_label='$'+latex(f)+'$')

                    @interact
                    def _(order=slider([1 .. 12])
                        ):
                        fp = x*product([1-x^2/(pi^2*k^2) for k in range(1, order+1)])
                        pretty_print(html(fr'$f(x) = {latex(f)}$'))
                        pretty_print(html(fr'$P_{{{order}}}f(x) = {latex(fp)}$'))
                        pt = plot(fp, -2*pi, 2*pi, color='green', thickness=1, linestyle='--', legend_label = fr'$P_{{{order}}}(x)$')
                        G = pf + pt
                        G.set_legend_options(font_size='x-large', loc='lower left', handlelength=0.01)
                        show(G, ymin=-2, ymax=2, figsize=5)
                </input>
                <output>
                </output>
            </sage>
            
            <sage>
                <input>
                    x   = var('x')
                    g = cos(x)
                    pg = plot(g, -2*pi, 2*pi, thickness=2, legend_label='$'+latex(g)+'$')

                    @interact
                    def _(order=slider([1 .. 12])
                        ):
                        gp = product([1-x^2/(pi^2*(k-1/2)^2) for k in range(1, order+1)])
                        pretty_print(html(fr'$g(x) = {latex(g)}$'))
                        pretty_print(html(fr'$P_{{{order}}}g(x) = {latex(gp)}$'))
                        pt = plot(gp, -2*pi, 2*pi, color='green', thickness=1, linestyle='--', legend_label = fr'$P_{{{order}}}g(x)$')
                        G = pg + pt
                        G.set_legend_options(font_size='x-large', loc='lower left', handlelength=0.01)
                        show(G, ymin=-2, ymax=2, figsize=5)
                </input>
                <output>
                </output>
            </sage>

        </subsection>

        <p>
            Try out your own Sage computations here:
        </p>
        <sage>
            <input>
                factorial(100)
            </input>
            <output>
            </output>
        </sage>
        

        
        
    </section>

</chapter>





















<!-- 


    <section xml:id="Sec-intor-old">
        <title>Older stuff - Ignore</title>

        <p>Have you ever wondered how your calculator actually calculates <m>e^x</m> or <m>\sin(x)</m> (or other non-polynomial functions) for particular values of <m>x</m>? Essentially, the way it is done is to write the function as an infinite series and then use as many terms of this series as necessary to obtain a value accurate to the number of digits in the calculator's display. For example, (as we will learn later on) the function <m>e^x</m> can be represented by the infinite series <me>1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots</me>.</p>

        <p>Thus, to calculate <m>e^{0.3}</m> say, we could put <m>x=0.3</m> into the series. As the table below shows, as we use more and more terms from the series it seems that the sum isn't changing in the first few decimal places. Thus we might claim that to four decimal digits <m>e^{0.3}=1.350</m>.</p>

        <tabular top="minor">
            <row header="yes" bottom="minor" left="minor">
                <cell halign="center" right="minor">Number of Terms</cell>
                <cell halign="center" right="minor">Sum</cell>
                <cell halign="center" right="minor">Value</cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>1</m></cell>
                <cell right="minor"><m>1</m></cell>
                <cell right="minor"><m>1</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>2</m></cell>
                <cell right="minor"><m>1+0.3</m></cell>
                <cell right="minor"><m>1.3</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>3</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}</m></cell>
                <cell right="minor"><m>1.345</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>4</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}+\dfrac{0.3^3}{3!}</m></cell>
                <cell right="minor"><m>1.3495</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>5</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}+\dfrac{0.3^3}{3!}+\dfrac{0.3^4}{4!}</m></cell>
                <cell right="minor"><m>1.3498375</m></cell>
            </row>
            <row bottom="minor" left="minor">
                <cell halign="center" right="minor"><m>6</m></cell>
                <cell right="minor"><m>1+0.3+\dfrac{0.3^2}{2!}+\dfrac{0.3^3}{3!}+\dfrac{0.3^4}{4!}+\dfrac{0.3^5}{5!}</m></cell>
                <cell right="minor"><m>1.3498775</m></cell>
            </row>
        </tabular>

        <p>We call <m>1, 1.3, 1.345, 1.3495, 1.3498375,  1.3498775, \ldots</m> the <term>sequence</term> of partial sums for <m>e^{0.3}</m>.</p>

        <p>Of course there are some really big questions here. Is it possible to find an infinite series representation for a given function? If so, how do we know that for any particular value of the independent variable the sum of more and more terms of the infinite series representation gets closer to the function value (or indeed any value at all)? These are the topics that we will address in this chapter.</p>

        <p>As a natural part of the discussion of the above questions we will also deal with the idea of approximating a function by a polynomial. We have seen previously (in Math1110) that near a given <m>x</m>-value a function can be approximated by its tangent. (We called such an approximation the linear approximation). For example, for values of <m>x</m> near <m>0</m> the function <m>e^x</m> can be approximated by the function <m>L(x)=x+1</m> which, as shown in <xref ref="Fig-Linear_approximation_of_exponential"/>, is the tangent to the function at <m>x=0</m>.</p>

        <sidebyside width="45%">
            <figure xml:id="Fig-Linear_approximation_of_exponential">
                <caption></caption>
                <image source="Calculus/Images/1/Linear_approximation_of_exponential.png"/>
            </figure>
            <figure xml:id="Fig-Quadratic_approximation_of_exponential">
                <caption></caption>
                <image source="Calculus/Images/1/Quadratic_approximation_of_exponential.png"/>
            </figure>
        </sidebyside>

        <sage>
          <input>
            f1 = 1
            f2 = 1 + x
            f3 = 1 + x + x^2/2
            plot([f1, f2, f3], (x, -3, 3))
          </input>
        </sage>

        <p>Notice that the linear approximation, <m>L(x)</m>, is the function obtained by truncating the infinite series representation for <m>e^x</m> (given above) after two terms. If we were to take the first three terms of the series we would have a quadratic approximation for <m>e^x</m>, i.e. <me>Q(x) = 1 + x + \frac{x^2}{2}.</me></p>
        <p>(See <xref ref="Fig-Quadratic_approximation_of_exponential"/>.) By using more terms from the infinite expansion we can obtain higher order polynomial approximations which we hope will be more accurate over a greater interval around the point of tangency. The idea of approximating a function by a polynomial has many uses in mathematics besides that of being used in calculators.</p>
    </section>


    <section xml:id="Sec-Infinite_Series_old">
        <title>Infinite Series</title>

        <p>In this section we will discuss the concepts and terminology associated with infinite series that we will need in order to discuss representing functions by infinite series. </p>

        <p>An <term>infinite series</term> is a sum of the form <me>\sum_{k=1}^{\infty}t_k = t_1 + t_2 +t_3 + \cdots</me> where <m>t_k</m> are (real) numbers.</p>

        <p>We call <m>t_1, t_1+t_2, t_1+t_2+t_3, \ldots</m> the <term>sequence</term> of partial sums for the series.</p>

        <example xml:id="Ex-Sample_infinite_series">
        <p>Both of the following are infinite series:
            <me>\sum_{k=1}^{\infty}\frac{1}{2^k} = \frac{1}{2^1}+\frac{1}{2^2}+\frac{1}{2^3} + \cdots = \frac{1}{2} + \frac{1}{4} + \frac{1}{8} + \cdots </me>
            <me>\sum_{k=1}^{\infty}(3k+1) = (3\times 0+1)+(3\times 1+1)+(3\times 2+1) + \cdots = 1 + 4 +7 + \cdots.</me>
        </p>
        </example>

        <p>The sum of a finite number of real <m>x</m> numbers is always finite. However, for an infinite sum, as we add more and more terms in the series the sum:
            <ul>
                <li>Might get closer and closer to some number. This is called <term>convergence</term>. For example <me>\sum_{k=1}^{\infty}\frac{1}{2^k}=\frac{1}{2^1}+\frac{1}{2^2}+\frac{1}{2^3}+\cdots = \frac{1}{2}+\frac{1}{4}+\frac{1}{8}+\cdots.</me> Sometimes a sum reaches a value and does not change (i.e. the terms become zero). We also call this convergence, e.g. <me>\sum_{k=1}^{\infty}0 = 0+0+0+\cdots = 0.</me></li>
                <li>Any other behaviour is called <term>divergence</term>. For example <me>\sum_{k=1}^{\infty}k = 1+2+3+\cdots</me> and <me>\sum_{k=1}^{\infty}(-1)^{k-1}=(-1)^0+(-1)^1+(-1)^2+\cdots = 1-1+1-1+1-\cdots</me> (this last example is actually tricky to define properly).</li>
            </ul>
        </p>

        <p>On adding the first <m>10</m> terms of the series <m>\displaystyle \sum_{k=1}^{\infty}\frac{1}{2^k}</m> we get <m>0.99902344\cdots</m>, on adding the first <m>20</m> terms we get <m>0.99999905\cdots</m>. So even though as we add more terms the sum is getting larger it is getting closer and closer to some fixed number. Adding lots of terms of the series (as we did above) suggests that for this case the sum is converging to <m>1</m>. If this is the case (and we will show below that it is) then we would say:
            <ul>
                <li>The series <term>converges</term> to <m>1</m></li>
                <li>The <term>sum</term> of the series is <m>1</m></li>
                <li>The <term>limit</term> of the series is <m>1</m></li>
            </ul>
        </p>

        <p>There is a lot of mathematics devoted to determining the nature of an infinite series. We will mention just three useful results.</p>
        <theorem>
            <title>The Divergence Test</title>
                <statement>
                    <p>
                      If the terms <m>t_k</m> of the series <m>\displaystyle \sum_{k=1}^{\infty}t_k</m> do not approach <m>0</m> as <m>k\to\infty</m> then the series diverges.
                    </p>
                </statement>
        </theorem>
        <theorem>
            <title>Geometric Progressions</title>
                <statement>
                    <p>
                      If the infinite series is a geometric progression (GP), i.e., of the form <me>\sum_{k=1}^{\infty}ar^k = a +ar +ar^2+ar^3 +\cdots</me> then it converges if and only if <m>|r|&lt; 1</m>, in which case it converges to <me>S=\frac{a}{1-r}.</me>
                    </p>
                </statement>
        </theorem>

        <theorem>
            <title>The Ratio Test</title>
                <statement>
                    <p>
                    For the series <m>\displaystyle \sum_{k=1}^{\infty}t_k</m>, let <m>\displaystyle L=\lim_{k\to \infty}\left|\dfrac{t_{k+1}}{t_k}\right|</m>. If
                    <ul>
                        <li><m>L&lt;1</m> then the series converges</li>
                        <li><m>L&gt;1</m> then the series diverges</li>
                        <li><m>L=1</m> then the test is inconclusive</li>
                    </ul>
                    </p>
                </statement>
        </theorem>

        <example xml:id="Ex-Divergence_test">
            <statement><p>Determine the nature of the series  <m>\displaystyle\sum_{k=1}^{\infty}k = 1+2+3+\cdots.</m></p></statement>
            <answer><p>Divergent.</p></answer>
            <solution>
                <p>
                    Since the terms of the series do not approach 0 as we go along the series, by the Divergence Test, this series diverges.
                </p>
            </solution>
        </example>

        <example xml:id="Ex-Geometric_progression">
            <statement><p>Determine the nature of the series  <me>\sum_{k=1}^{\infty}\frac{1}{2^k} = \dfrac{1}{2}+\dfrac{1}{4}+\dfrac{1}{8}+\cdots.</me></p></statement>
            <answer><p>Convergent.</p></answer>
            <solution>
                <p>
                    This infinite series is a GP with <m>a=\dfrac{1}{2}</m> and <m>r=\dfrac{1}{2}</m>. Since <m>|r|&lt;1</m> the series converges and converges to <me>S=\dfrac{1/2}{1-1/2} =1.</me>
                </p>
            </solution>
        </example>

        <example xml:id="Ex-Ratio_test">
            <statement><p>Determine the nature of the series  <me>\sum_{k=1}^{\infty}\frac{k+1}{2^k} = 1+\dfrac{3}{4}+\dfrac{1}{2}+\dfrac{5}{16}+\cdots.</me></p></statement>
            <answer><p>Convergent.</p></answer>
            <solution>
                <p>To use the ratio test consider <me>\dfrac{t_{k+1}}{t_k} = \dfrac{k+2}{2^{k+1}}\cdot\dfrac{2^k}{k+1} = \dfrac{1}{2}\left(\dfrac{k+2}{k+1}\right).</me></p>
                <p>Thus <me>L=\lim_{k\to\infty}\left|\dfrac{1}{2}\left(\dfrac{k+2}{k+1}\right)\right|=\dfrac{1}{2}.</me></p>
                <p>Since <m>L&lt;1</m>, by the ratio test this series converges. (Notice that the ratio test doesn't tell us to what number the series converges to. In this case it is <m>3</m>.)</p>
            </solution>
        </example>

        <p>We eventually want to represent a function via an infinite series. To do so the infinite series will have to involve a variable (the independent variable of the function). Clearly for an infinite series involving a variable the behaviour of the series will depend upon the value of the variable.</p>

        <example xml:id="Ex-Power_series_motivation">
            <statement><p>For which values of <m>x</m> will the following series converge?<me>\sum_{k=0}^{\infty}\left(\dfrac{-2x}{3}\right)^k = 1-\dfrac{2}{3}x + \dfrac{4}{9}x^2 -\dfrac{8}{27}x^3 + \cdots.</me></p></statement>
            <answer><p><m>-\dfrac{3}{2} &lt; x &lt; \dfrac{3}{2}</m>.</p></answer>
            <solution>
                <p>Note that this is a GP with <m>a=1</m> and <m>r=\dfrac{-2x}{3}</m>. Thus the series will only converge for those values of <m>x</m> that satisfy <m>\left|\dfrac{-2x}{3}\right| &lt; 1 </m>, that is, <m>-\dfrac{3}{2} &lt; x &lt; \dfrac{3}{2}</m>.</p>
                <p>Just to check this, let <m>x=1</m>. Then the series becomes <me>\sum_{k=0}^{\infty}\left(\dfrac{-2}{3}\right)^k = 1-\dfrac{2}{3} + \dfrac{4}{9} -\dfrac{8}{27} + \cdots</me> which converges to <m>S=\dfrac{1}{1+2/3}=\dfrac{3}{5}</m>. Note that, on adding the first <m>20</m> terms of the series we get <m>0.59981956\cdots</m> and on adding the first <m>50</m> terms we get <m>0.59999991\cdots</m>, and so it does indeed seem that the sum is <m>3/5</m>.</p>
            </solution>
        </example>

        <definition>
            <title>Power Series</title>
            <statement>
                <p>A <term>power series</term> about <m>a</m> is an infinite series of the form <me>\sum_{k=0}^{\infty}c_k(x-a)^k = c_0 + c_1(x-a) + c_2(x-a)^2 + c_3(x-a)^3 + \cdots</me> where the <m>c_k</m> are real numbers.</p>
            </statement>
        </definition>

        <example xml:id="Ex-Power_series_geometric">
            <p> The series <me>\sum_{k=0}^{\infty}x^k = 1+x+x^2+x^3+\cdots</me> is a power series about <m>0</m> (with <m>c_k=1</m> for all <m>k</m>). There are several points worth noting about this power series.
                <ul>
                    <li>The series definitely converges when <m>x = 0</m>.</li>
                    <li>The series is a GP with <m>a=1</m> and <m>r=x</m> and so converges for <m>|x|&lt;1</m>.</li>
                    <li>When the series converges it converges to <m>S=\dfrac{1}{1-x}</m>.</li>
                </ul>
                This last point is interesting because it is telling us that for <m>f(x)=\dfrac{1}{1-x}</m> if <m>|x|&lt;1</m> we have <me>f(x)=\sum_{k=0}^{\infty}x^k.</me>
            </p>
        </example>

        <example xml:id="Ex-Power_series_ratio_test">
            <p> The series <me>\sum_{k=0}^{\infty}\dfrac{(x-1)^k}{k+1} = 1+\dfrac{x-1}{2}+\dfrac{(x-1)^2}{3}+\cdots</me> is a power series about <m>1</m>. For this series
                <ul>
                    <li>It definitely converges for <m>x = 1</m>.</li>
                    <li><p>It can be shown, via the ratio test, that the series converges for <m>0 &lt; x &lt;2</m>. Firstly, <me>L =\lim_{k\to\infty}\left|\dfrac{(x-1)^{k+1}}{k+2}\cdot\dfrac{k+1}{(x-1)^k}\right| = |x-1|.</me> Thus <m>L&lt;1</m> when <m>|x-1|&lt;1</m>, i.e., <m>0 &lt; x &lt;2</m>.</p>
                        <p>For example, with <m>x=3/2</m> adding the first <m>20</m> terms gives <m>1.3862947\cdots</m> while adding the first <m>50</m> terms gives <m>1.3862943\cdots</m>.</p>
                    </li>
                    <li>For <m>0 &lt; x &lt;2</m> we can think of this infinite series as defining a function, i.e. <me>f(x) = \sum_{k=0}^{\infty}\dfrac{(x-1)^k}{k+1}.</me> In which case, as we saw above, <m>f(3/2)=1.3863</m> to <m>4</m> d.p.</li>
                </ul>
            </p>
        </example>

        <remark>
            <p>Note that it can be shown that a power series about <m>x=a</m> either
                <ul>
                    <li>Converges only for <m>x=a</m></li>
                    <li>Converges for <m>|x-a|&lt;R</m> and diverges for <m>|x-a|&gt;R</m> (note what happens when <m>|x-a|=R</m> depends on the particular power series)</li>
                    <li>Converges for all <m>x</m></li>
                </ul>
                The value of <m>R</m> is called the <term>radius of convergence</term>. In the first case we say <m>R=0</m> and in the third case we say <m>R=\infty</m>. The collection of those <m>x</m> for which the series converges is called the <term>interval of convergence</term> <m>I</m> of the power series.
            </p>
        </remark>

        <exercises>
            <title>Example Tasks</title>
            <exercise>
                <statement>
                    <p>Determine whether the following series converge or diverge. If the series is a convergent GP then find its sum.
                        <ol label="a" cols="2">
                            <li><m>\displaystyle \sum_{k=0}^{\infty}\dfrac{1}{3+2^{-k}}</m></li>
                            <li><m>\displaystyle \sum_{k=1}^{\infty}\dfrac{3}{10^{k}}</m></li>
                            <li><m>\displaystyle \sum_{k=1}^{\infty}\dfrac{k^3}{3^k}</m></li>
                            <li><m>\displaystyle \sum_{k=1}^{\infty}\dfrac{k}{k^2+4}</m></li>
                        </ol>
                    </p>
                </statement>
            </exercise>

            <exercise>
                <statement>
                    <p>Determine the interval of convergence for the following series.
                        <ol label="a" cols="2">
                            <li><m>\displaystyle \sum_{k=1}^{\infty}\dfrac{(3x-2)^k}{k\,3^k}</m></li>
                            <li><m>\displaystyle \sum_{k=1}^{\infty}(-1)^k\dfrac{x^{2k}}{(2k)!}</m></li>
                        </ol>
                    </p>
                </statement>
            </exercise>
        </exercises>

        <remark>
            <title>Aside</title>
                <p>
                    Computer algebra systems usually have commands for summing infinite series. For example, with Wolfram Alpha you can just type in the first few terms as shown.
                </p>
                <figure xml:id="Fig-C1_WA_1">
                    <image source="./Calculus/Images/1/C1_WA_1.png" width="90%"/>
                </figure>
                <p>
                   The following example shows another query to Wolfram Alpha and the associated output.
                </p>
                <figure xml:id="Fig-C1_WA_2">
                        <image source="./Calculus/Images/1/C1_WA_2.png" width="90%"/>
                </figure>
        </remark>
    </section>




    <section xml:id="Sec-Maclaurin_Series">
        <title>Maclaurin Series</title>

        <p>In this section we will discuss the task of finding an infinite series representation for a given function of one variable, <m>f</m>. We begin by assuming that the given function <m>f(x)</m> does indeed have a power series representation, at least initially about <m>x=0</m>. Thus we assume that on some interval <m>|x| &lt; R</m> <men xml:id="Eq-Maclaurin_of_f">f(x) = \sum_{k=0}^{\infty}c_kx^k = c_0 + c_1x +c_2x^2 +c_3x^3 + \cdots.</men></p>

        <p>We know that the power series reduces to <m>c_0</m> when <m>x=0</m> and so for the power series to match the function when <m>x=0</m> we must have <m>c_0 = f(0)</m>. On differentiating <xref ref="Eq-Maclaurin_of_f"/> we get <men xml:id="Eq-First_derivative_Maclaurin">f'(x) = \sum_{k=1}^{\infty}kc_kx^{k-1} = c_1 +2c_2x +3c_3x^2 + 4c_4x^3 + \cdots</men>
        and on putting <m>x=0</m> into this gives <m>c_1=f'(0)</m>. Similarly, differentiating <xref ref="Eq-First_derivative_Maclaurin"/> <men>f''(x) = \sum_{k=2}^{\infty}k(k-1)c_kx^{k-2} = 2c_2 +6c_3x + 12c_4x^2 + \cdots</men>
        and substituting <m>x=0</m> gives <m>c_2=\dfrac{1}{2}f''(0)</m>. By continuing this process, we can see that in general <men>f^{(n)}(x) = \sum_{k=n}^{\infty}k(k-1)(k-2)\cdots(k-(n-1))c_kx^{k-n}</men>
        and hence (by substituting <m>x=0</m>) that <m>c_n = \dfrac{1}{n!}f^{(n)}(0)</m>.
        </p>

        <definition>
            <title>Maclaurin Series</title>
            <statement>
                <p>The series <me>\sum_{k=0}^{\infty}\dfrac{f^{(k)}(0)}{k!}x^k = f(0) + f'(0)x +\dfrac{f^{''}(0)}{2!}x^2 +\dfrac{f^{'''}(0)}{3!}x^3 + \cdots</me> is called the <term>Maclaurin series</term> for <m>f(x)</m>.</p>
            </statement>
        </definition>


        <p>We know that the Maclaurin series for <m>f</m> converges when <m>x=0</m> (since all power series converge for <m>x=a</m>) and we also know that the series converges to <m>f(0)</m> (because we constructed it that way). However for other values of <m>x</m> we cannot be sure that the infinite series will converge and if it does, does it converge to the function value.</p>

        <example xml:id="Ex-Maclaurin_series_geometric">
            <statement><p>Find the Maclaurin series for <m>f(x)=\dfrac{1}{1-x}</m>.</p></statement>
            <answer><p><m>\displaystyle \sum_{k=0}^{\infty}x^k = 1+x+x^2+x^3+x^4+ \cdots</m></p></answer>
            <solution>
                <p>Firstly find the derivatives of <m>f</m> and evaluate them at <m>x=0</m>.
                <md alignment="alignat">
                    <mrow>f(x) \amp = (1-x)^{-1} \text{ and hence } f(0)=1</mrow>
                    <mrow>f'(x) \amp = (1-x)^{-2} \text{ and hence } f'(0)=1</mrow>
                    <mrow>f''(x) \amp = 2(1-x)^{-3} \text{ and hence } f''(0)=2</mrow>
                    <mrow>\quad\amp \vdots \quad </mrow>
                    <mrow>f^{(k)}(x) \amp = k!(1-x)^{-k-1} \text{ and hence } f^{(k)}(0) = k!</mrow>
                </md>
                Substituting these results into the formula derived above gives the Maclaurin series for <m>f</m> as
                <me>\sum_{k=0}^{\infty}\dfrac{k!}{k!}x^k = \sum_{k=0}^{\infty}x^k = 1+x+x^2+x^3+x^4+ \cdots.</me>
                This agrees with the result that we found in an earlier example. As we saw in that example, however, the Maclaurin series only converges for <m>|x| &lt;1 </m> and that for those values it converges to the function value.
                </p>
            </solution>
        </example>


        <definition>
            <title>Maclaurin Polynomial</title>
            <statement>
                <p>The <m>n</m>th partial sum of the Maclaurin series for <m>f(x)</m>, i.e., <me>\sum_{k=0}^{n}\dfrac{f^{(k)}(0)}{k!}x^k = f(0) + f'(0)x +\dfrac{f^{''}(0)}{2!}x^2 +\cdots + \dfrac{f^{(n)}(0)}{n!}x^n </me> is called the <term>Maclaurin polynomial of degree <m>n</m></term> for <m>f(x)</m>.</p>
            </statement>
        </definition>


        <example xml:id="Ex-Maclaurin_polynomial_cosine">
            <statement><p>Find the Maclaurin polynomials of degree <m>0,1,2,3</m> and <m>4</m> for the function <m>f(x)=\cos(x)</m>.</p></statement>
            <answer>
                <p>
                <md>
                <mrow>M_0(x)\amp=1</mrow>
                <mrow>M_1(x)\amp=1</mrow>
                <mrow>M_2(x)\amp=1-\dfrac{x^2}{2}</mrow>
                <mrow>M_3(x)\amp=1-\dfrac{x^2}{2}</mrow>
                <mrow>M_4(x)\amp=1-\dfrac{x^2}{2}+\dfrac{x^4}{24}</mrow>
                </md>
                </p>
            </answer>
            <solution>
                <p>For <m>f(x)=\cos(x)</m>,
                <md alignment="alignat">
                    <mrow>f(x) \amp = \cos(x) \text{ and hence } f(0)=1</mrow>
                    <mrow>f'(x) \amp = -\sin(x) \text{ and hence } f'(0)=0</mrow>
                    <mrow>f''(x) \amp = -\cos(x) \text{ and hence } f''(0)=-1</mrow>
                    <mrow>f'''(x) \amp = \sin(x) \text{ and hence } f'''(0)=0</mrow>
                    <mrow>f^{(iv)}(x) \amp = \cos(x) \text{ and hence } f^{(iv)}(0)=1</mrow>
                </md>
                and so the <m>0</m>th degree Maclaurin polynomial is <me>M_0(x)=f(0)=1.</me>
                Notice that the <m>0</m>th degree Maclaurin polynomial is the horizontal line passing through the point <m>(0,f(0))</m>.
                </p>
                <p>The <m>1</m>st degree Maclaurin polynomial is
                    <md alignment="alignat">
                        <mrow>M_1(x) \amp = f(0) + f'(0)x</mrow>
                        <mrow>        \amp = 1+0</mrow>
                        <mrow>        \amp = 1</mrow>
                    </md>
                Notice that the <m>1</m>st degree Maclaurin polynomial is the tangent to the function at the point  <m>(0,f(0))</m>. Notice also, that in this case, the <m>0</m>th degree and the <m>1</m>st  degree Maclaurin polynomials are the same.
                </p>
                <p>
                The <m>2</m>nd degree Maclaurin polynomial is
                    <md alignment="alignat">
                        <mrow>M_2(x) \amp = f(0) + f'(0)x + \dfrac{f''(0)}{2}x^2</mrow>
                        <mrow>        \amp = 1+0x + \dfrac{(-1)}{2}x^2</mrow>
                        <mrow>        \amp = 1-\dfrac{x^2}{2}</mrow>
                    </md>
                </p>
                <p>
                The <m>3</m>rd degree Maclaurin polynomial is
                    <md alignment="alignat">
                        <mrow>M_3(x)  \amp = f(0) + f'(0)x + \dfrac{f''(0)}{2}x^2 + \dfrac{f'''(0)}{3!}x^3</mrow>
                        <mrow>        \amp = 1+0x + \dfrac{(-1)}{2}x^2 + \dfrac{0}{3!}x^3</mrow>
                        <mrow>        \amp = 1-\dfrac{x^2}{2}</mrow>
                    </md>
                </p>
                <p>
                The <m>4</m>th degree Maclaurin polynomial is
                    <md alignment="alignat">
                        <mrow>M_4(x)  \amp = f(0) + f'(0)x + \dfrac{f''(0)}{2}x^2 + \dfrac{f'''(0)}{3!}x^3 + \dfrac{f^{(iv)}(0)}{4!}x^4</mrow>
                        <mrow>        \amp = 1+0x + \dfrac{(-1)}{2}x^2 + \dfrac{0}{3!}x^3 + \dfrac{1}{4!}x^4</mrow>
                        <mrow>        \amp = 1-\dfrac{x^2}{2} + \dfrac{x^4}{24}</mrow>
                    </md>
                As can be seen in <xref ref="Fig-Maclaurin_polynomial_cosine"/>, in this case as the degree of the Maclaurin polynomial increases so the polynomial provides a good approximation to the function for a larger interval surrounding <m>x=0</m>. In fact, using the Ratio test we can show that the Maclaurin series for <m>\cos(x)</m> converges for all values of <m>x</m> and by using some more advanced mathematics we can show that the series converges to <m>\cos(x)</m> for all values of <m>x</m>.
                </p>
                <figure xml:id="Fig-Maclaurin_polynomial_cosine">
                    <image source="./Calculus/Images/1/Fig-Maclaurin_polynomial_cosine.png" width="90%"/>
                </figure>
            </solution>
        </example>

        <exercises>
            <title>Example Tasks</title>
            <exercise>
                <statement>
                Let <m>f(x)=e^x</m>. Find the Maclaurin series for <m>f</m> and find its interval of convergence.
                </statement>
            </exercise>
            <exercise>
                <statement>
                Find the Maclaurin polynomial of degree <m>3</m> for <m>g(x) = \tan^{-1}(x)</m>.
                </statement>
            </exercise>
        </exercises>

        <remark>
            <title>Aside</title>
                <p>
                    Computer Algebra Systems usually have a command for calculating Maclaurin series. For example, the following shows part of the output from a Wolfram Alpha query.
                </p>
                <figure xml:id="Fig-C1_WA_3">
                    <image source="./Calculus/Images/1/C1_WA_3.png" width="90%"/>
                </figure>
        </remark>

    </section>
</chapter>

-->
