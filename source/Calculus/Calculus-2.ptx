<?xml version="1.0" encoding="UTF-8" ?>
<!-- =================================================================================================== -->
<!-- To process this file with xsltproc do                                                        -->
<!--                                                                                              -->
<!-- (1) LaTeX/PDF:                                                                               -->
<!--     xsltproc -o minimal.tex PATH_TO/mathbook/xsl/pretext-latex.xsl source/main.ptx           -->
<!--     pdflatex minimal.tex                                                                     -->
<!--     xelatex minimal.tex                                                                      -->
<!--                                                                                              -->
<!-- (2) HTML:                                                                                    -->
<!--     xsltproc PATH_TO/mathbook/xsl/pretext-html.xsl source/main.ptx                           -->
<!--     <browser>  minimal.html                                                                  -->
<!--        ~/xsltproc/xsltproc.exe ~/mathbook/xsl/mathbook-html.xsl test.xml                     -->
<!--                                                                                              -->
<!-- (3) CoCalc worksheet (parameter causes a single file for output)                             -->
<!--     REMOVE the "X" in the double dash (which is not legal in an XML comment)                 -->
<!--     xsltproc -X-stringparam chunk.level 0 PATH_TO/mathbook/xsl/pretext-smc.xsl source/main.ptx   -->
<!--     <CoCalc> minimal.sagews                                                                  -->
<!--                                                                                              -->
<!-- (4) Sage doctesting                                                                          -->
<!--     REMOVE the "X" in the double dash (which is not legal in an XML comment)                 -->
<!--     xsltproc -X-stringparam chunk.level 0 PATH_TO/mathbook/xsl/pretext-sage-doctest.xsl source/main.ptx  -->
<!--     <read further instructions in> minimal.py                                                -->
<!-- =================================================================================================== -->

<chapter xml:id="Calculus_2">



<!-- =================================================================================================== -->
<!-- Title and Other Preliminaries -->
<!-- =================================================================================================== -->
        <title>CA8: Taylor Series</title>

        <!-- <frontmatter> -->

<!--             <titlepage>
                <author>
                    <institution>University of Newcastle</institution>
                </author>
                <date><today /></date>
            </titlepage> -->

            <!-- <abstract>
                <p>This is a very short article, but it still exercises some advanced features of MathBook XML.</p>
            </abstract> -->

        <!-- </frontmatter> -->

        <!-- <introduction>
            <p>This is a short paragraph to introduce the article (but it is not the abstract).  It is optional, in case it would be preferable to have the first section be titled an <q>Introduction.</q></p>
        </introduction> -->
<!-- =================================================================================================== -->

<section xml:id="sec-Taylor-series">
    <title>Taylor series</title>

    <figure xml:id="fig-plot-sin-T5">
        <caption>Plot of <m>\sin(x)</m> and its degree 5 Maclaurin polynomial.</caption>
        <image source="Calculus/Images/2/sin-vs-T5-plot" width="100%">
            <description>Plot of <m>\sin(x)</m> and its degree 5 Maclaurin polynomial.
            The polynomial starts diverging visibly from the plot of <m>\sin(x)</m> when <m>|x|\gt 2</m>.
            </description>
        </image>
    </figure>

    <p>
        <xref ref="fig-plot-sin-T5"/> compares <m>\sin(x)</m> to its degree 5 Maclaurin polynomial. 
        We notice that the polynomial is a poor approximation of <m>\sin(x)</m> when <m>|x| \gt 2</m>. 
        What can we do about this? We could use Maclaurin polynomials of ever higher degree, 
        but these get ever more complicated.
    </p>

    <p>
        The issue is that Maclaurin series are computed based on the value of the function and its 
        derivatives around <m>x=0</m>, so it's not surprising that they best approximate the function near <m>x=0.</m>
        If for some reason we're more interested in the function near another value, say near <m>x=a</m>,
        then instead of computing Maclaurin polynomials of high degree, we can simply shift our function along 
        the <m>x</m>-axis until the point of interest lies above <m>x=0</m>, 
        compute the Maclaurin polynomials of the shifted function, and then shift back.
    </p>

    <p>
        In other words, we consider the shifted function <m>g(x) = f(x+a)</m>, then compute the Maclaurin series 
        for <m>g(x)</m>: 
        <me>
            g(x) = \sum_{k=0}^{\infty} \frac{g^{(k)}(0)}{k!}x^k = \sum_{k=0}^{\infty} \frac{f^{(k)}(a)}{k!}x^k
        </me>
        Finally, we shift back to obtain a power series for <m>f(x) = g(x-a)</m>: 
        <me>
            f(x) = g(x-a) = \sum_{k=0}^{\infty} \frac{f^{(k)}(a)}{k!}(x-a)^k.
        </me>
        This is the <term>Taylor series</term> for <m>f(x)</m> <term>centred at</term> <m>x=a</m>. 
    </p>

    <definition>
        <title>Taylor Series</title>
        <statement>
            <p>The series, </p>
             <p>   <me>\sum_{k=0}^{\infty}\dfrac{f^{(k)}(a)}{k!}(x-a)^k=f(a)+f'(a)(x-a)+\dfrac{f''(a)}{2!}(x-a)^{2}+\dfrac{f'''(a)}{3!}(x-a)^3+ \dots </me>.</p>
            <p>is called the <term>Taylor series</term> for <m> f(x) </m> about   <m> x=a. </m>  </p>
        </statement>
    </definition>

    <p>
        Note that a Maclaurin series is simply a Taylor series centred at <m>x=0.</m>
    </p>

    <p>
        The degree <m>n</m> <term>Taylor polynomial</term> of <m>f(x)</m> centred at <m>x=a</m> is - you guessed it - the sum of the terms of the 
        Taylor series of degree at most <m>n</m>. 
        The degree <m>n</m> Taylor polynomial of a function is also called its <term>nth order approximation</term>.
    </p>


    <example>
        <statement>
            <p>
                Compute the Taylor series of the function <m>\cos(x)</m> centred at <m>x=\frac{\pi}{4}</m>.
            </p>
        </statement>
        <solution>
            <p>
                We compute the derivatives of <m>f(x) = \cos(x)</m> at <m>x=\frac{\pi}{4}</m>:
                <md>
                    <mrow>f(x) \amp = \cos(x), \amp f\left(\frac{\pi}{4}\right) \amp = \frac{1}{\sqrt{2}}</mrow>
                    <mrow>f'(x) \amp = -\sin(x), \amp f'\left(\frac{\pi}{4}\right) \amp = -\frac{1}{\sqrt{2}} </mrow>
                    <mrow>f''(x) \amp = -\cos(x), \amp f''\left(\frac{\pi}{4}\right) \amp = -\frac{1}{\sqrt{2}} </mrow>
                    <mrow>f'''(x) \amp = \sin(x), \amp f'''\left(\frac{\pi}{4}\right) \amp = \frac{1}{\sqrt{2}} </mrow>
                    <mrow>f^{(4)}(x) \amp = f(x), \amp f^{(4)}\left(\frac{\pi}{4}\right) \amp = f\left(\frac{\pi}{4}\right) = \frac{1}{\sqrt{2}} </mrow>
                </md>
                Thus 
                <md>
                    <mrow>\cos(x) \amp = \frac{1}{\sqrt{2}} -\frac{1}{\sqrt{2}}\left(x-\frac{\pi}{4}\right) 
                        -\frac{1}{2!\sqrt{2}}\left(x-\frac{\pi}{4}\right)^2 + \frac{1}{3!\sqrt{2}}\left(x-\frac{\pi}{4}\right)^3 + \cdots
                    </mrow>
                </md>
            </p>
        </solution>
    </example>

    <figure xml:id="fig-plot-cos-T3">
        <caption>Degree 3 Taylor polynomial of <m>\cos(x)</m> centred at <m>x=\frac{\pi}{4}</m></caption>
        <image source="Calculus/Images/2/cos-vs-T3-pi4-plot" width="100%">
            <description>Plot of <m>\cos(x)</m> and its degree 3 Taylor polynomial centered at <m>x=\frac{\pi}{4}</m>.</description>
        </image>
    </figure>

    <p>
        The Sage cell below plots the Taylor polynomial for a function <m>f(x)</m> centred at some <m>x=a</m>.
    </p>

    <sage>
        <input>
            x   = var('x')

            @interact
            def _(f = input_box(default='sin(x)', label='f(x)='),
                x0=input_box(default=pi/4, label='centre'),
                order=slider([1 .. 12])):
                p   = plot(f, -2*pi, 2*pi, thickness=2, legend_label='f(x)')
                dot = point((x0, f(x=x0)), pointsize=80, rgbcolor=(1, 0, 0))
                ft = f.taylor(x, x0, order)
                pt = plot(ft, -2*pi, 2*pi, color='green', thickness=2, legend_label=r'T_'+str(order)+'f(x)')
                pretty_print(html(r'$f(x)\;=\;%s$' % latex(f)))
                pretty_print(html(r'$T_{%s}f(x)\;=\;%s$' % (order, latex(ft))))
                show(dot + p + pt, ymin=-1, ymax=1)
        </input>
    </sage>

    <example xml:id="Second_order_approximation_e_power_minus_x_on_3">

        <p>Find the second order approximation to   <m> f(x)=e^{-\frac{x}{3}} </m> about <m> x=2. </m>  </p>
        <answer>
            <p><m>T_{2}(x)=e^{-\frac{2}{3}}-\dfrac{1}{3}e^{-\frac{2}{3}}(x-2)+\dfrac{1}{18}e^{-\frac{2}{3}}(x-2)^{2}</m></p>
        </answer>
         <solution>
                <p> In order to find the second order approximation for <m> f(x)=e^{-\frac{x}{3}} </m> about <m> x=2 </m> we need to evaluate <m> f </m> and its first two derivatives at <m> x=2</m>.  So,  </p>
                    <p><md>
                    <mrow> f(x) \amp =e^{-\frac{x}{3}}  \,\, \text{and hence}\,\,   f(2)=e^{-\frac{2}{3}}  </mrow>
                    <mrow> f'(x) \amp =-\frac{1}{3}e^{-\frac{x}{3}}  \,\, \text{and hence}\,\,   f'(2)=-\frac{1}{3}e^{-\frac{2}{3}} </mrow>
                    <mrow> f''(x) \amp =\frac{1}{9}e^{-\frac{x}{3}}  \,\, \text{and hence}\,\,   f''(2)=\frac{1}{9}e^{-\frac{2}{3}}   </mrow>
                    </md></p>
                <p> Thus the second order approximation for <m> f(x)=e^{-\frac{x}{3}} </m> about <m> x=2, </m> (or the Taylor polynomial of degree <m> 2, </m> for <m> f(x)=e^{-\frac{x}{3}} </m> about <m> x=2</m>), is </p>
               <p><md>
                    <mrow> T_{2}(x) \amp =e^{-\frac{2}{3}}-\frac{1}{3}e^{-\frac{2}{3}}(x-2)+\frac{1}{9}e^{-\frac{2}{3}}\dfrac{(x-2)^{2}}{2}  </mrow>
                    <mrow> \amp =e^{-\frac{2}{3}}-\frac{1}{3}e^{-\frac{2}{3}}(x-2)+\frac{1}{18}e^{-\frac{2}{3}}(x-2)^{2} </mrow>
                    </md></p>
            </solution>
    </example>

    
    

<example xml:id="Fourth_order_approximation_e_power_minus_x_on_3">

        <p> Find the Taylor polynomial of degree <m> 4 </m> for <m> f(x)=x\cos(x) </m>  about <m> x=\frac{\pi}{2}. </m>  </p>
        <answer>
            <p><m>T_{4}(x) = -\dfrac{\pi}{2}  (x-\dfrac{\pi}{2}) -  (x-\dfrac{\pi}{2})^2 +  \dfrac{\pi}{2} \dfrac{(x-\dfrac{\pi}{2})^3}{3!}  + \dfrac{(x-\dfrac{\pi}{2})^4}{3!}</m></p>
        </answer>
        
         <solution>
                <p> Since we already know the Taylor series for  <m> \cos(x) </m>  about  <m> x=\frac{\pi}{2}  </m>   we can obtain the <m> 4^{\text{th}} </m> degree Taylor polynomial for <m> f(x)=x\cos(x) </m> about <m> x=\frac{\pi}{2} </m> as follows </p>
                    <p><md>
                    <mrow> f(x) \amp = x\cos(x)  </mrow>
                    <mrow>  \amp = (x-\frac{\pi}{2})\cos(x)+\frac{\pi}{2}\cos(x) </mrow>
                    <mrow>   \amp = (x-\frac{\pi}{2})  \left[-(x-\frac{\pi}{2}) + \frac{(x-\frac{\pi}{2})^3}{3!} -  \frac{(x-\frac{\pi}{2})^5}{5!} + \dots   \right] + \frac{\pi}{2}\left[ -(x-\frac{\pi}{2}) +  \frac{(x-\frac{\pi}{2})^3}{3!} -  \frac{(x-\frac{\pi}{2})^5}{5!} + \dots   \right] </mrow>
                    <mrow>   \amp = \left[-(x-\frac{\pi}{2})^2 + \frac{(x-\frac{\pi}{2})^4}{3!} - \dots   \right] + \left[ -\frac{\pi}{2}(x-\frac{\pi}{2}) + \frac{\pi}{2}\frac{(x-\frac{\pi}{2})^3}{3!} - \dots   \right]. </mrow>
                    </md></p>
                <p> Thus the <m> 4^{\text{th}} </m> degree Taylor polynomial is </p>
               <p><me>
                  T_{4}(x) = -\frac{\pi}{2}  (x-\frac{\pi}{2}) -  (x-\frac{\pi}{2})^2 +  \frac{\pi}{2} \frac{(x-\frac{\pi}{2})^3}{3!}  + \frac{(x-\frac{\pi}{2})^4}{3!}.
                    </me></p>
            </solution>
</example>

          <exercises>
        <title>Example Tasks</title>

        <exercise>
            <statement>
                <p> Find the Taylor series for <m>f(x)=\ln(x)</m> about <m>x=e.</m> </p>
            </statement>
        </exercise>

            <exercise>
            <statement>
                <p> Find the Taylor polynomial of degree  <m> 3 </m> for   <m> f(x)=\dfrac{1}{1-x} </m> about <m> x=2. </m>  </p>
            </statement>
        </exercise>

            <exercise>
            <statement>
                <p> Find the Taylor polynomial of degree  <m> 4 </m> for   <m> f(x)=x\ln(x) </m> about <m> x=e. </m>  </p>
            </statement>
        </exercise>

            <exercise>
            <statement>
                <p>  Find the <m>3</m>rd degree Taylor polynomial for <m> f(x)=x^2 e^{x} </m> about <m> x=1. </m>  </p>
            </statement>
        </exercise>
</exercises>
         <remark>
        <title>A little remark</title>
            <p>
                Computer algebra systems usually have commands for Taylor series. For example, here in <xref ref="Fig-Taylor_series_cos_Mathematica"/> is an example of a query to Wolfram Alpha that will work.
            </p>
            <figure xml:id="Fig-Taylor_series_cos_Mathematica">
                <image source="./Calculus/Images/2/Taylor_series_cos_Mathematica.png" width="90%"/>
            </figure>
        </remark>

    
    
</section>

    

    <section xml:id="sec-Geometric-series">
        <title>Geometric series</title>
        
        <p>
            So far, we have succeeded in finding various useful power series expressions for the functions <m>\sin(x)</m>, <m>\cos(x)</m> and <m>e^x</m>. 
            What about other functions? 
            A particularly instructive case is the function 
            <me>
                f(x) = \frac{1}{1-x}.
            </me>
        </p>
        <p>
            We can compute its derivatives by hand, but that quickly gets old, so we'll ask the computer instead:
        </p>
        <sage>
            <input>
                f = 1/(1-x)
                N = 10
                for k in range(N):
                    print(diff(f, x, k))
            </input>
        </sage>
        <p>
            We notice that
            <men xml:id="eq-GS1">
                \frac{d^n}{dx^n} \frac{1}{1-x} = \frac{n!}{(1-x)^{n+1}} \quad \text{for}\quad n \ge 0.
            </men>
            (Note that Sage often formats the answer differently, swapping the <m>x</m> and <m>1</m> around, leading to alternating signs.)
        </p>
        <exercise>
            <statement>
                <p>
                    Use induction on <m>n</m> to prove that the formula in <xref ref="eq-GS1"/> is correct.
                </p>
            </statement>
        </exercise>
        <p>
            This allows us to write down the Maclaurin series for <m>f(x) = \frac{1}{1-x}</m>:
            <men xml:id="eq-GS2">
                \frac{1}{1-x} = 1 + x + x^2 + x^3 + \cdots = \sum_{k=0}^\infty x^k.
            </men>
        </p>
        

        <exercise xml:id="ex-GS">
            <task>
                <statement>
                    <p>
                        Prove that, for every <m>n \ge 0</m>,
                        <me>
                            x^{n+1} - 1 = (x-1)(x^n + x^{n-1} + \cdots + x + 1).
                        </me>
                        Deduce that
                        <men xml:id="eq-GS3">
                            1 + x + x^2 + \cdots + x^n = \frac{1-x^{n+1}}{1-x}.
                        </men>
                    </p>
                </statement>
                <hint>
                    <p>
                        You can use induction on <m>n</m>, or just multiply out and cancel terms.
                    </p>
                </hint>
            </task>
            <task>
                <statement>
                    <p>
                        Assuming that <m>|x| \lt 1</m>, deduce <xref ref="eq-GS2"/> from <xref ref="eq-GS3"/>.
                    </p>
                </statement>
                <hint>
                    <p>
                        Take the limit as <m>n \rightarrow \infty</m>.
                    </p>
                </hint>
                <solution>
                    <p>
                        We compute
                        <md>
                            <mrow>\sum_{k=0}^\infty x^k \amp = \lim_{N\rightarrow\infty} \sum_{k=0}^N x^k </mrow>
                            <mrow> \amp = \lim_{N\rightarrow\infty} \frac{1-x^{N+1}}{1-x} </mrow>
                            <mrow> \amp = \frac{1}{1-x}</mrow>
                        </md>
                        since <m>x^N \rightarrow 0</m> as <m>N\rightarrow\infty</m> because <m>|x| \lt 1</m>. 
                    </p>
                </solution>
            </task>
        </exercise>
<!--
        <p>
            The series <xref ref="eq-GS2"/> is very neat, and interesting for a variety of reasons. 
        </p>
-->

        <p>
            The series in <xref ref="eq-GS2"/> is an example of a <term>geometric series</term> (sometimes also called a <em>geometric progression</em>). 
            More generally, a geometric series is one of the form
            <men xml:id="def-GS">
                \sum_{k=0}^\infty ar^k = a + ar + ar^2 + \cdots, \qquad\text{where}\quad |r|\lt 1.
            </men>
            Here <m>a</m> is the starting term, and each subsequent term equals the previous terms multiplied by <m>r</m>, which we call the <term>common ratio</term>.
        </p>
        <p>
            Let's plot the various Maclaurin polynomials for <m>f(x)=1/(1-x)</m>:
        </p>

        <figure xml:id="fig-plot-GS">
            <caption>Maclaurin polynomials for <m>f(x)=1/(1-x)</m></caption>
            <image source="Calculus/Images/2/GS-plot" width="100%">
                <description>Plot of the Maclaurin polynomials for <m>f(x)=1/(1-x)</m>. Note how they only approximate <m>1/(1-x)</m> when <m>|x| \lt 1</m>.</description>
            </image>
        </figure>

        <p>
            We immediately notice that the Maclaurin polynomials are wildy different from <m>1/(1-x)</m> when <m>|x| \geq 1</m>.
            
        </p>

        
        
    </section>


    <section xml:id="sec-Convergence-issues">
        <title>Convergence issues</title>

        <p>
            Of course, the problem is that the series <xref ref="eq-GS2"/> does not converge unless <m>|x| \lt 1</m> - 
            after all, if <m>|x| \geq 1</m>, then the individual terms <m>x^k</m> do not shrink to zero, and the partial sums cannot converge to a limit.
            This is true for all series:
        </p>

        <theorem>
            <title>The Divergence Test</title>
                <statement>
                    <p>
                      If the terms <m>t_k</m> of the series <m>\displaystyle \sum_{k=1}^{\infty}t_k</m> do not approach <m>0</m> as <m>k\to\infty</m> then the series diverges.
                    </p>
                </statement>
        </theorem>

        <p>
            This is obvious if you think about it: if the series converges, then the partial sums (running totals) tend to some fixed limit. 
            But this means that the changes from one partial sum to the next (i.e. the terms of the series) must shrink to zero.
        </p>

        <p>
            We will soon see that the converse is not true: there are series, whose terms tend to zero, but which nevertheless diverge. 
            One can think of this problem as the terms not tending to zero <em>fast enough.</em>
        </p>

        <theorem>
            <title>Geometric Series</title>
                <statement>
                    <p>
                        A geometric series
                        <me>
                            \sum_{k=0}^{\infty}ar^k = a +ar +ar^2+ar^3 +\cdots \qquad (a\neq 0)
                        </me> 
                        converges if and only if <m>|r| \lt 1</m>, in which case it converges to 
                        <me>
                            S=\frac{a}{1-r}.
                        </me>
                    </p>
                </statement>
        </theorem>
        <proof>
            <p>
                If <m>|r| \geq 1</m>, then <m>\lim_{k\rightarrow\infty}ar^k</m> does not equal zero, so by the Divergence Test, the series diverges. 
            </p>
            <p>
                Now suppose that <m>|r| \lt 1</m>. By the result of <xref ref="ex-GS"/>, we have
                <me>
                    a + ar + ar^2 + \cdots + ar^N = a(1 + r + r^2 + \cdots + r^N) = a\frac{1-r^{N+1}}{1-r},
                </me>
                So 
                <md>
                    <mrow>\sum_{k=0}^\infty ar^k \amp = a \lim_{N\rightarrow\infty} \sum_{k=0}^N r^k </mrow>
                    <mrow> \amp = a \lim_{N\rightarrow\infty} \frac{1-r^{N+1}}{1-r} </mrow>
                    <mrow> \amp = a \frac{1}{1-r}</mrow>
                </md>
                since <m>r^{N+1} \rightarrow 0</m> as <m>N\rightarrow\infty</m> because <m>|r| \lt 1</m>. 
            </p>
        </proof>
        <example>
            <p>
                Repeating decimals are also geometric series:
                <md>
                    <mrow>0.333333\ldots \amp = 3\cdot 10^{-1} + 3\cdot 10^{-2} + 3\cdot 10^{-3} + \cdots </mrow>
                    <mrow> \amp = \frac{3\cdot 10^{-1}}{1-10^{-1}} = \frac{1}{3}. </mrow>
                </md>
            </p>
        </example>
    </section>

    

    <section xml:id="sec-Ratio-test">
        <title>Ratio test</title>

        <p>
            Most series aren't obligingly geometric series, but a similar principle applies: 
            if the ratios of consecutive terms stay small (specifically, tend to a value strictly between <m>1</m> and <m>-1</m>), then we can expect convergence:
        </p>
        <theorem>
            <title>The Ratio Test</title>
                <statement>
                    <p>
                    For the series <m>\displaystyle \sum_{k=1}^{\infty}t_k</m>, let <m>\displaystyle L=\lim_{k\to \infty}\left|\dfrac{t_{k+1}}{t_k}\right|</m>. If
                    <ul>
                        <li><m>L&lt;1</m> then the series converges</li>
                        <li><m>L&gt;1</m> then the series diverges</li>
                        <li><m>L=1</m> then the test is inconclusive</li>
                    </ul>
                    </p>
                </statement>
        </theorem>

        <aside>
            <p>
                We can actually do slightly better: in the Ratio Test we can replace 
                <m>\displaystyle L=\lim_{k\to \infty}\left|\dfrac{t_{k+1}}{t_k}\right|</m>
                by
                <m>\displaystyle L=\limsup_{k\to \infty}\left|\dfrac{t_{k+1}}{t_k}\right|</m>.
            </p>
            <p>
                If you don't yet know what a limsup is, here is another way of putting it: 
                If there exists a number <m>L \lt 1</m>, such that 
                <m>\displaystyle \left|\dfrac{t_{k+1}}{t_k}\right| \leq L</m> for all sufficiently large <m>k</m>,
                then the series converges.
            </p>
            <p>
                The idea is simply that, in this case, the terms in the series shrink to zero faster than the terms of a (convergent) geometric series 
                with common ratio <m>L \lt 1</m>, and thus it must also converge.
            </p>
        </aside>

        <p>
            In other courses you will learn more about convergence of series and in particular you will see more convergence tests. 
            Annoyingly, all convergence tests have cases in which they're inconclusive. 
            One can actually prove that, in a suitable technical sense, a universal convergence test cannot exist.
        </p>

        <example xml:id="Ex-Ratio_test">
            <statement>
                <p>
                    Determine the nature of the series  
                    <me>
                        \sum_{k=1}^{\infty}\frac{k+1}{2^k} = 1+\dfrac{3}{4}+\dfrac{1}{2}+\dfrac{5}{16}+\cdots.
                    </me>
                </p>
            </statement>
            <answer>
                <p>
                    Convergent.
                </p>
            </answer>
            <solution>
                <p>
                    To use the ratio test consider 
                    <me>
                        \dfrac{t_{k+1}}{t_k} = \dfrac{k+2}{2^{k+1}}\cdot\dfrac{2^k}{k+1} = \dfrac{1}{2}\left(\dfrac{k+2}{k+1}\right).
                    </me>
                </p>
                <p>
                    Thus 
                    <me>
                        L=\lim_{k\to\infty}\left|\dfrac{1}{2}\left(\dfrac{k+2}{k+1}\right)\right|=\dfrac{1}{2}.
                    </me>
                </p>
                <p>
                    Since <m>L = \frac{1}{2} \lt 1</m>, by the ratio test this series converges. 
                    (Notice that the ratio test doesn't tell us to what number the series converges to. In this case it happens to be <m>3</m>.)
                </p>
            </solution>
        </example>
        
    </section>


    <section xml:id="sec-Convergence-of-power-series">
        <title>Convergence of power series</title>

        <p>
            It turns out that the Ratio Test is well suited for testing the convergence of power series.
            Consider a general power series, of the form
            <me>
                f(x) = c_0 + c_1(x-a) + c_2(x-a)^2 + \cdots = \sum_{k=0}^\infty c_k(x-a)^k.
            </me>
            We'd like to know for which values of <m>x</m> this series converges.
            After all, if the series doesn't converge for a particular <m>x</m>, then it tells us nothing about the 
            value of the function at <m>x</m>.
        </p>
        <p>
            Firstly, when <m>x=a</m>, then <m>f(a) = c_0 + 0 + 0 + \cdots</m> obviously converges to the first term <m>c_0</m>.
            In other words, <em>a power series always converges at its centre.</em>
        </p>
        <p>
            For other values of <m>x</m>, we apply the Ratio Test.
            To do so, we check the (absolute values of) ratios of consecutive terms, and try to determine if they converge to something smaller than 1.
            Due to the nature of power series, there is some cancellation in this ratio:
            <md>
                <mrow>\left| \frac{c_{k+1}(x-a)^{k+1}}{c_k(x-a)^k} \right| \amp = \left|\frac{c_{k+1}}{c_k} \right| \cdot |x-a| </mrow>
            </md>
            For the Ratio Test to apply, this must converge to some <m>L</m> as <m>k \rightarrow \infty</m>. 
            This depends on the ratios of the coefficients <m>c_k</m> of the power series.
            Assuming the ratios converge to something, we find three possibilities.
        </p>
        <p>
            <term>Case 1.</term> If
            <m>
               \displaystyle \lim_{k\rightarrow\infty} \frac{c_{k+1}}{c_k} = 0
            </m>
            then the series converges for all <m>x</m>:
            <me>
                L = \lim_{k\to\infty}\left| \frac{c_{k+1}(x-a)^{k+1}}{c_k(x-a)^k} \right| = \lim_{k\to\infty}\left|\frac{c_{k+1}}{c_k} \right| \cdot |x-a| = 0 \lt 1.
            </me>
            <example>
                <p>
                    Consider the Maclaurin series for <m>e^x</m>:
                    <me>
                        e^x = \sum_{k=0}^{\infty} \frac{1}{k!}x^k.
                    </me>
                    Here
                    <md>
                        <mrow>L = \lim_{k\rightarrow\infty} \left| \frac{\frac{1}{(k+1)!}(x-a)^{k+1}}{\frac{1}{k!}(x-a)^k} \right| \amp =  \lim_{k\to\infty}\left|\frac{k!}{(k+1)!} \right| \cdot|x| </mrow>
                        <mrow> \amp =  \lim_{k\to\infty}\left|\frac{k!}{k!(k+1)} \right| \cdot|x| </mrow>
                        <mrow> \amp =  \lim_{k\to\infty}\left|\frac{1}{k+1} \right| \cdot|x| </mrow>
                        <mrow> \amp = 0. </mrow>
                    </md>
                    Thus the Maclaurin series for <m>e^x</m> converges for all values of <m>x</m>. 
                </p>
                <p>
                    It's not hard to show that the same holds for the Taylor series of <m>f(x) = e^x</m>, <m>\cos(x)</m> and <m>\sin(x)</m> about any centre.
                    The reason is that the derivatives <m>f^{(n)}(a)</m> are bounded (by <m>e^a</m> in the case of <m>f(x)=e^x</m>, and by <m>1</m> in the case of <m>f(x)=\cos(x)</m> or <m>f(x)=\sin(x)</m>),
                    thus in the Ratio Test calculation, the factorials in the denominators dominate everything.
                </p>
            </example>
        </p>
        <p>
            <term>Case 2.</term> If
            <m>
                \displaystyle \lim_{k\rightarrow\infty} \frac{c_{k+1}}{c_k} = C \neq 0, \infty
            </m>
            then the series converges for <m>|x-a| \lt R = \frac{1}{C}</m> and diverges if 
            <m>|x-a| \gt R</m>:
            <md>
                <mrow>L = \lim_{k\to\infty}\left| \frac{c_{k+1}(x-a)^{k+1}}{c_k(x-a)^k} \right| \amp = \lim_{k\to\infty}\left|\frac{c_{k+1}}{c_k} \right| \cdot |x-a|</mrow>
                <mrow> \amp = C |x-a|. </mrow>
            </md>
            This will converge if <m>C |x-a| = L \lt 1</m>, i.e. when <m>|x-a| \lt \frac{1}{C}</m>. 
        </p>
        <p>
            In this case, we call <m>R</m> the <term>radius of convergence</term> of the power series.
            Basically, the series converges if the distance from <m>x</m> to the centre <m>a</m> is less than the radius of convergence <m>R</m>.
            If this distance is greater than <m>R</m>, then the series diverges.
        </p>
        <p>
            In other words, the series converges for <m>x</m> inside the open interval <m>(a-R, a+R)</m>, and diverges outside the closed interval <m>[a-R, a+R]</m>.
        </p>
        <p>
            What happens on the endpoints of these intervals, i.e. when <m>x = a \pm R</m>? 
            The Ratio Test tells us nothing. 
            All we know at this point is that there is an <term>interval of convergence</term>, of the form
            <me>
                (a-R, a+R),\quad\text{or}\quad [a-R, a+R], \quad\text{or}\quad (a-R, a+R], \quad\text{or}\quad [a-R, a+R).
            </me>
            But we won't worry about convergence at the endpoints in this course. 
        </p>
        <aside>
            <title>Where's the circle?</title>
            <p>
                Why is the radius of convergence called a <em>radius?</em>
                Where's the circle?
            </p>
            <p>
                The answer becomes clear when we consider the variable <m>x</m> to be a <em>complex</em> number,
                rather than just a real number. 
                Everything we've done up to now also makes sense over complex number, especially power series, and in this case the 
                interval of convergence turns out to be a <em>disk</em> of convergence.
                The series will converge for <m>|x-a| \lt R</m>, and this region defines a disk in the complex plane, centered at <m>x=a</m>, with radius <m>R</m>.
            </p>
        </aside>
        <example>
            <statement>
                <p>
                    Compute the radius of convergence of <m>\sum_{k=0}^{\infty}\frac{3^k}{k}(x-1)^k</m>.
                </p>
            </statement>
            <solution>
                <p>
                    We use the Ratio Test:
                    <md>
                        <mrow>L \amp = \lim_{k\rightarrow\infty} \left|\frac{\frac{3^{k+1}}{k+1}(x-1)^{k+1}}{\frac{3^k}{k}(x-1)^k} \right| </mrow>
                        <mrow> \amp = \lim_{k\rightarrow\infty} 3\frac{k}{k+1}\cdot |x-1| </mrow>
                        <mrow> \amp = 3|x-1|, </mrow>
                    </md>
                    because 
                    <me>
                        \lim_{k\rightarrow\infty} \frac{k}{k+1} = \lim_{k\rightarrow\infty} \frac{1}{1 + \frac{1}{k}} = \frac{1}{1+0} = 1.
                    </me>
                    
                    Now <m>L \lt 1</m> when <m>|x-1| \lt \frac{1}{3}</m>. 
                    So we find that the series converges for <m>|x-1| \lt \frac{1}{3}</m>, i.e. on the interval <m>(\frac{2}{3}, \frac{4}{3})</m>, 
                    and the radius of convergence is <m>R=\frac{1}{3}</m>.
                </p>
            </solution>
        </example>

        <p>
            <term>Case 3.</term> If
            <m>
                \displaystyle \lim_{k\rightarrow\infty} \frac{c_{k+1}}{c_k} = \infty,
            </m>
            then the series diverges for all <m>x\neq a</m>:
            <md>
                <mrow>L \amp = \lim_{k\to\infty}\left| \frac{c_{k+1}(x-a)^{k+1}}{c_k(x-a)^k} \right|</mrow> 
                <mrow> \amp = \lim_{k\to\infty}\left|\frac{c_{k+1}}{c_k} \right| \cdot |x-a|</mrow>
                <mrow> \amp = \infty, </mrow>
            </md>
            so <m>L = 3|x-1| \gt 1</m> unless <m>x = a</m>. 
            In this case we say the radius of convergence is zero: <m>R=0</m>.
        </p>
        <p>
            Just to round things off, in the first case, where the series converges for all <m>x</m>, we say that it has <term>infinite radius of convergence</term>.
        </p>
        
    </section>


<!-- =================================================================================================== -->
<!--  -->
<!-- =================================================================================================== -->


    <section xml:id="sec-Algebra-of-infinite-series">
        <title>Algebra of infinite series</title>
        <p>
            Computing repeated derivatives gets old really quickly. 
            Often a much quicker way to get power series expansions for given functions is to manipulate a known series.
        </p>
 
        <p>
            In <xref ref="Table_Maclaurin"/> below we have listed the Maclaurin series for a small set of basic functions of science and engineering. 
            These series can all be relatively easily derived from first principals as discussed in previous lectures. 
            However, for some more complex functions it is easier to find their Maclaurin series by starting from known series rather than trying to find the series from scratch. 
            We will look at two commonly used techniques:
        </p>

        <p>
            <ul>
                <li>  Manipulating/Substituting into known series. </li >
                <li>  Differentiating/Integrating known series.   </li>
            </ul>
        </p>

<table xml:id="Table_Maclaurin">
  <title>Some Important Maclaurin Series (and their intervals of convergence):</title>
  <tabular>
    <row>
      <cell><m>\dfrac{1}{1-x}=\sum_{k=0}^{\infty}x^{k}=1+x+x^{2}+x^{3}+\cdots</m></cell>
      <cell><m>\lvert x\rvert &lt; 1</m></cell>
    </row>
    <row>
      <cell><m>e^{x}=\sum_{k=0}^{\infty}\dfrac{x^{k}}{k!}=1+x+\dfrac{x^{2}}{2!} +\dfrac{x^{3}}{3!}+\cdots</m></cell>
      <cell><m>\mathbb{R}</m></cell>
    </row>
    <row>
      <cell><m>\sin(x)=\sum_{k=0}^{\infty}(-1)^{k}\dfrac{x^{2k+1}}{(2k+1)!}=x-\dfrac{x^{3}}{3!} +\dfrac{x^{5}}{5!}-\cdots</m></cell>
      <cell><m>\mathbb{R}</m></cell>
    </row>
    <row>
      <cell><m>\cos(x)=\sum_{k=0}^{\infty}(-1)^{k}\dfrac{x^{2k}}{(2k)!}=1-\dfrac{x^{2}}{2!} +\dfrac{x^{4}}{4!}-\cdots</m></cell>
      <cell><m>\mathbb{R}</m></cell>
    </row>
    <row>
      <cell><m>\ln(1+x)=\sum_{k=1}^{\infty}(-1)^{k-1}\dfrac{x^{k}}{k}=x-\dfrac{x^{2}}{2} +\dfrac{x^{3}}{3}-\cdots</m></cell>
      <cell><m>\lvert x\rvert &lt; 1</m></cell>
    </row>
    <row>
      <cell><m>\tan^{-1}(1+x)=\sum_{k=0}^{\infty}(-1)^{k}\dfrac{x^{2k+1}}{2k+1}=x-\dfrac{x^{3}}{3} +\dfrac{x^{5}}{5}-\cdots</m></cell>
      <cell><m>\lvert x\rvert &lt; 1</m></cell>
    </row>
    <row>
      <cell><m>\sinh(x)=\sum_{k=0}^{\infty}\dfrac{x^{2k+1}}{(2k+1)!}=x+\dfrac{x^{3}}{3!} +\dfrac{x^{5}}{5!}+\cdots</m></cell>
      <cell><m>\mathbb{R}</m></cell>
    </row>
    <row>
      <cell><m>\cosh(x)=\sum_{k=0}^{\infty}\dfrac{x^{2k}}{(2k)!}=1+\dfrac{x^{2}}{2!} +\dfrac{x^{4}}{4!}+\cdots</m></cell>
      <cell><m>\mathbb{R}</m></cell>
    </row>
  </tabular>
</table>

<paragraphs><title>Manipulating/Substituting into Known Series</title></paragraphs>

<example xml:id="Maclaurin_series_1_on_1_plus_x2">
    <statement>
        <p>Find the Maclaurin series for  <m> f(x)=\dfrac{1}{1+x^{2}}. </m> </p>
    </statement>
    <answer>
        <p><m>\dfrac{1}{1+x^{2}}=\displaystyle\sum_{k=0}^{\infty}(-1)^{k}x^{2k}</m></p>
    </answer>
    <solution>
        <p>We know that the Maclaurin series for<m>f(x)=\dfrac{1}{1-x}</m> on <m>\lvert x\rvert &lt; 1 </m> is </p>
        <me>  \dfrac{1}{1-x}=\sum_{k=0}^{\infty}x^{k}=1+x+x^{2}+x^{3}+\cdots \cdot </me>
        <p>We can use this series by replacing <m> x </m> with <m> -x^{2} </m> to obtain </p>
        <p><md>
            <mrow>\dfrac{1}{1+x^{2}} \amp =\dfrac{1}{1-(-x^{2})}</mrow>
            <mrow> \amp = 1+(-x^{2})+(-x^{2})^{2}+(-x^{2})^{3}+\cdots</mrow>
            <mrow> \amp = 1-x^{2} +x^{4}-x^6+\cdots</mrow>
            <mrow> \amp = \sum_{k=0}^{\infty}(-1)^{k}x^{2k}</mrow>
        </md></p>
        <p> which will converge on the interval <m>\lvert -x^{2}\rvert &lt; 1, </m> i.e., <m> -1&lt; x &lt; 1. </m>  </p>
        </solution>
</example>

<example xml:id="Maclaurin_series_x_on_2_minus_5x">
        <statement>
            <p>Find the Maclaurin series for  <m> f(x)=\dfrac{x^2}{2-5x}. </m> </p>
        </statement>
        <answer>
            <p><m>\dfrac{x^2}{2-5x}=\dfrac{x^2}{2}\displaystyle\sum_{k=0}^{\infty}\left(\dfrac{5x}{2}\right)^{k}</m></p>
        </answer>
        <solution>
            <p>Once again we will use the Maclaurin series for <m>f(x)=\dfrac{1}{1-x}</m> on <m>\lvert x\rvert &lt; 1. </m> Now </p>
                <p><md>
                    <mrow> \frac{x^2}{2-5x} \amp =\dfrac{x^{2}}{2}\left(\dfrac{1}{1-(\frac{5x}{2})}\right)</mrow>
                    <mrow> \amp = \dfrac{x^2}{2}\left(1+\left(\frac{5x}{2}\right)+\left(\frac{5x}{2}\right)^{2}+\left(\frac{5x}{2}\right)^{3}+\cdots\right)</mrow>
                    <mrow> \amp = \dfrac{x^2}{2}\sum_{k=0}^{\infty}\left(\dfrac{5x}{2}\right)^{k}</mrow>
                </md></p>
            <p> which will converge on the interval <m>\lvert \frac{5x}{2}\rvert &lt; 1, </m> i.e., <m> -\frac{2}{5}&lt; x &lt; \frac{2}{5}. </m>  </p>
        </solution>
</example>

<example xml:id="Maclaurin_series_e_minus_x_2">
        <statement>
            <p>Find the Maclaurin series for  <m> f(x)=e^{-x^2}. </m> </p>
        </statement>
        <answer>
            <p><m>e^{-x^2}=\displaystyle\sum_{k=0}^{\infty}(-1)^{k}\dfrac{x^{2k}}{k!}</m></p>
        </answer>
        
             <solution>
                    <p>Substituting into the Maclaurin series for  <m>f(x)=e^{x}</m>, we obtain </p>
                        <p><md>
                        <mrow>e^{-x^2} \amp =\sum_{k=0}^{\infty}\dfrac{(-x^2)^{k}}{k!}=\sum_{k=0}^{\infty}(-1)^{k}\dfrac{x^{2k}}{k!}</mrow>
                        <mrow> \amp = 1- x^{2}+\frac{x^{4}}{2!}-\frac{x^{6}}{3!}+\cdots</mrow>
                    </md></p>
                   <p> which will converge for all real values of <m> x. </m>  </p>
                </solution>
</example>


<paragraphs><title>Differentiating/Integrating Known Series</title></paragraphs>
<p> As the theorem below says, we can also use differentiation and integration to work out new Maclaurin series expansions from ones that we already know. The proof of this theorem is beyond the scope of this course.  </p>

<theorem>
                <statement>
                    <p>
                      If  <m>f(x)=\sum\limits_{k=0}^{\infty}c_{k}x^{k}</m> with radius of convergence <m>R</m> then                    </p>
                  <p><ul>
            <li><p> <m>f'(x)=\sum\limits_{k=0}^{\infty}k c_{k}x^{k-1}</m> with radius of convergence <m>R</m>, </p></li>
            <li><p><m> \int f(x)dx=K+ \sum\limits_{k=0}^{\infty} \dfrac{c_{k}}{k+1}x^{k-1}</m> with radius of convergence <m>R</m> (where <m>K\in\mathbb{R}</m>). </p></li>
        </ul></p>
                </statement>
        </theorem>

<p> Note that the behaviour of the series (i.e. whether it converges or diverges) at the endpoints may change when it is differentiated or integrated. </p>

<example xml:id="Maclaurin_series_1_on_1_minus_x_power_2">
        <statement>
            <p>Find the Maclaurin series for  <m> f(x)=\dfrac{1}{(1-x)^{2}}.</m> </p>
        </statement>
        <answer>
            <p><m>\dfrac{1}{(1-x)^{2}}=\displaystyle\sum_{k=1}^{\infty} k x^{k-1}</m></p>
        </answer>
             <solution>
                    <p> Notice that <m>\int \frac{1}{(1-x)^{2}} dx=\frac{1}{1-x}, </m> or put the other way, <m> \frac{1}{(1-x)^{2}}=\frac{d}{dx} \left(\frac{1}{1-x}\right). </m> Since we know the Maclaurin series for <m> \frac{1}{1-x} </m> we can differentiate this series to obtain the Maclaurin series for <m> \frac{1}{(1-x)^{2}}. </m> So, on <m>\lvert x\rvert &lt; 1, </m>  </p>
                        <p><md>
                        <mrow> \frac{1}{(1-x)^{2}} \amp =\frac{d}{dx}\left(\sum_{k=0}^{\infty} x^{k}\right)</mrow>
                        <mrow> \amp = \sum_{k=1}^{\infty} k x^{k-1}</mrow>
                        <mrow> \amp = 1+2x+3x^2+4x^3+\dots </mrow>
                    </md></p>
                </solution>
</example>


<example xml:id="Maclaurin_series_ln_1_plus_x">
        <statement>
            <p>Find the Maclaurin series for  <m> f(x)=\ln(1+x).</m> </p>
        </statement>
        <answer>
            <p><m>\ln(1+x)=\displaystyle\sum_{k=1}^{\infty}(-1)^{k-1}\dfrac{x^{k}}{k}</m></p>
        </answer>
        
             <solution>
                    <p> Notice that <m> \frac{d}{dx}(\ln(1+x)), </m> or put the other way, <m> \ln(1+x)=K+\int \frac{1}{1+x} dx</m>. Since we know the Maclaurin series for <m> \frac{1}{1+x} </m> we can integrate this series to obtain the Maclaurin series for <m> \ln(1+x).</m> So, on <m>\lvert x\rvert &lt; 1, </m>  </p>
                        <p><md>
                        <mrow> \ln(1+x) \amp = K+\int \left(\sum_{k=0}^{\infty} (-x)^{k}\right)dx</mrow>
                        <mrow> \amp = K+\sum_{k=0}^{\infty} (-1)^{k}\frac{x^{k+1}}{k+1}</mrow>
                        <mrow> \amp = K + x - \frac{1}{2}x^{2} +\frac{1}{3}x^{3} - \dots</mrow>
                    </md></p>
                    <p> Since <m> \ln(1+x)</m> is <m> 0 </m> when <m> x=0 </m> we have <m> K=0. </m> Thus on <m>\lvert x\rvert &lt; 1 </m> </p>
                     <me>  \ln(1+x)=\sum_{k=1}^{\infty}(-1)^{k-1}\frac{x^{k}}{k}=x-\frac{x^{2}}{2}+\frac{x^{3}}{3}-\cdots \cdot </me>
                </solution>
</example>


        <exercises>
            <title>Example Tasks</title>

            <exercise>
                <statement>
                    <p> Find the Maclaurin series for  <m> f(x)=\dfrac{1}{3+2x}. </m> </p>
                </statement>
            </exercise>

                <exercise>
                <statement>
                    <p> Find the Maclaurin series for  <m> f(x)=\dfrac{1-x^2}{5-3x^2}. </m> </p>
                </statement>
            </exercise>

                <exercise>
                <statement>
                    <p>  Find the Maclaurin series for <m> f(x)=\dfrac{1}{(1-2x)^2}. </m> </p>
                </statement>
            </exercise>

                <exercise>
                <statement>
                    <p> Find the Maclaurin series for <m> f(x)=\tan^{-1}(x). </m> </p>
                </statement>
            </exercise>

                            <exercise>
                <statement>
                    <p> Use a sixth degree Maclaurin polynomial to estimate  <m> f(x)=\displaystyle\int_{0}^{1}e^{-x^{2}}dx. </m> </p>
                </statement>
            </exercise>


        </exercises>
     </section>



     <section xml:id="sec-Advanced-topics2">
        <title>Advanced topics</title>

        <subsection xml:id="subsec-Why-radius-1">
            <title>Why radius 1?</title>

            <p>
                In <xref ref="Maclaurin_series_1_on_1_plus_x2"/> we worked out the Maclaurin series of 
                <m> f(x)=\dfrac{1}{1+x^{2}} </m> and found that it has radius of convergence <m>R=1</m>.
            </p>

            <p>
                What's wrong with this function? 
                The plot in <xref ref="fig-1-over-x-squared"/> shows a perfectly well-behaved function, defined on all of <m>\R</m>,
                but its Maclaurin polynomials are all over the place when <m>|x| \gt 1</m>.
                Why is the radius of convergence so small?
            </p>

            <figure width="%" xml:id="fig-1-over-x-squared">
                <caption>Approximations to <m>\frac{1}{1+x^2}</m> by its Maclaurin polynomials up to degree 30.</caption>
                <image xml:id="sage-exp-plot-2" source="Calculus/Images/2/plot-1-over-x-squared" width="100%">
                    <description>A plot of <m>y=\frac{1}{1+x^2}</m> together with plots of its Maclaurin polynomials up to degree 30.</description>
                </image>
            </figure>

            <p>
                The answer becomes clear if we view <m>f(x)=\frac{1}{1+x^2}</m> as a function of a <em>complex</em> variable! 
                Over the complex numbers, the denominator vanishes at <m>x = \pm i</m>, so the function blows up at these values.
                These are at distance 1 from the origin, so the disc of convergence in the complex plane cannot include these points,
                and so the radius of this disc (the radius of convergence!) cannot be larger than 1.
            </p>
            <p>
                In fact, it is a result from <em>Complex Analysis</em> that the radius of convergence of the Taylor series of an <em>analytic</em> function 
                is always the distance from the centre of the Taylor series to the nearest singularity of the function. 
                In our case, this distance is 1.
            </p>
            
            
        </subsection>


     </section>

     <!--
        
        <subsection xml:id="subsec-Integral-test">
            <title>Integral test</title>
            
        </subsection>

        <subsection xml:id="subsec-Absolute-conditional-convergence">
            <title>Absolute vs. conditional convergence</title>
            <p>
                Rearrangement of conditionally convergent series can make your head explode.
            </p>
        </subsection>

        <subsection xml:id="subsec-Convergence-complex">
            <title>Convergence in the complex plane</title>
            
        </subsection>

        <subsection xml:id="subsec-Euler-product">
            <title>The Euler product of the zeta function</title>
            
        </subsection>

    </section>




           <section xml:id="Taylor_Series">
            <title>Taylor Series</title>

 <p >Maclaurin series are power series about <m> x=0. </m>  However we can follow exactly the same process to find a power series expansion for a function   <m> f(x) </m> about any point   <m> x=a. </m>  We call these power series Taylor Series. </p>


        <definition>
            <title>Taylor Series</title>
            <statement>
                <p>The series, </p>
                 <p>   <me>\sum_{k=0}^{\infty}\dfrac{f^{(k)}(a)}{k!}(x-a)^k=f(a)+f'(a)(x-a)+\dfrac{f''(a)}{2!}(x-a)^{2}+\dfrac{f'''(a)}{3!}(x-a)^3+ \dots </me>.</p>
                <p>is called the <term>Taylor series</term> for <m> f(x) </m> about   <m> x=a. </m>  </p>
            </statement>
        </definition>

 <p > Note that: </p>
 <p >
<ol >
<li > We can construct the Taylor series about  <m>x=a.  </m>  for any function that is infinitely differentiable at  <m>x=a.  </m> </li >
<li >
<p >
The Taylor series for <m>f</m> about <m> x=a </m> always converges to <m>f(a)</m> at <m> x=a. </m>
</p >
</li >
 <li >
<p >
If the Taylor series converges for other values of <m> x </m> these will be in an interval centred on <m> x=a. </m>
</p >
</li >
 <li >
<p >
It is possible that a Taylor series may converge to a value other than the function value.
</p >
</li >
 <li >
<p >
A Maclaurin series is just a Taylor series about  <m>x=0.  </m>
 </p >
</li >
<li >
<p >
The <m> n^{\text{th}} </m>  partial sum of the Taylor series for <m> f </m> about <m> x=a </m>  is called the <term><m> n^{\text{th}} </m> degree Taylor polynomial</term> for <m> f </m> about  <m> x=a. </m>
</p >
</li >
</ol >
</p >

      <example xml:id="Taylor_series_cos">

            <p>Find the Taylor series for   <m> f(x)=\cos(x) </m> about <m> x=\frac{\pi}{2} </m>  </p>
            <answer>
                <p><m>\displaystyle\sum_{k=1}^{\infty}(-1)^{k}\dfrac{(x-\frac{\pi}{2})^{2k-1}}{(2k-1)!}</m></p>
            </answer>
             <solution>
                    <p> In order to find the Taylor series for   <m> f(x)=\cos(x) </m> about <m> x=\frac{\pi}{2} </m>   we need to evaluate <m> f </m> and its derivatives at  <m> x=\frac{\pi}{2}. </m>  So,  </p>
                    <p><md>
                       <mrow> f(x) \amp =\cos(x)  \,\, \text{and hence}\,\,   f\left(\frac{\pi}{2}\right)=0  </mrow>
                        <mrow> f'(x) \amp =-\sin(x)  \,\, \text{and hence}\,\,   f'\left(\frac{\pi}{2}\right)=-1 </mrow>
                        <mrow> f''(x) \amp =-\cos(x)  \,\, \text{and hence}\,\,   f''\left(\frac{\pi}{2}\right)=0  </mrow>
                         <mrow> f'''(x) \amp =\sin(x)  \,\, \text{and hence}\,\,   f'''\left(\frac{\pi}{2}\right)=1 </mrow>
                         <mrow>\amp \hspace{5.5cm}  \vdots </mrow>
                          <mrow>\amp \hspace{4.6cm}  f^{(k)}\left(\frac{\pi}{2}\right)=\begin{cases} 0 \amp k\;\, \text{even} \\
           (-1)^{\frac{k+1}{2}} \amp  k \;\, \text{odd} \end{cases} </mrow>
                    </md></p>
                    <p> Thus the Taylor series for  <m> f(x)=\cos(x) </m> about <m> x=\frac{\pi}{2} </m>  is </p>
<p><md>
                        <mrow>  \amp = 0-(x-\frac{\pi}{2})+0+\frac{1}{3!}(x-\frac{\pi}{2})^{3}-\frac{1}{5!}(x-\frac{\pi}{2})^{5}+\dots</mrow>
                        <mrow> \amp =-(x-\frac{\pi}{2})+\frac{(x-\frac{\pi}{2})^{3}}{3!}-\frac{(x-\frac{\pi}{2})^{5}}{5!}+\dots</mrow>
                        <mrow> \amp = \sum_{k=1}^{\infty}(-1)^{k}\dfrac{(x-\frac{\pi}{2})^{2k-1}}{(2k-1)!}.</mrow>
                    </md></p>
                  <p> It turns out that this series converges to  <m> f(x)=\cos(x) </m> for all values of <m> x. </m>  <xref ref="Fig-Taylor_series_cos"/> shows the graph of <m> f(x)=\cos(x) </m> and the Taylor polynomials of degree <m> 1 </m>  and degree <m>  3    </m> about <m> x=\frac{\pi}{2} .</m>   </p>
                     <figure xml:id="Fig-Taylor_series_cos">
                <caption></caption>
                <image source="./Calculus/Images/2/Taylor_series_cos.png" width="85%"/>
            </figure>
                </solution>
</example>








        </section>
    -->
<!-- =================================================================================================== -->
</chapter>
